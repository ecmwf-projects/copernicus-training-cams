
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>European Air Quality Index Calculation &#8212; CAMS Training</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Ozone Monitoring Tutorial" href="08_Ozone_Monitoring_Tutorial.html" />
    <link rel="prev" title="Profile Plots and Zonal Means" href="06_Profile_Plot_Zonal_Mean.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/CAMS–POS–LINE.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">CAMS Training</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Copernicus Atmosphere Monitoring Service (CAMS) Data Tutorials
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Access Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_Atmosphere_Data_Store.html">
   Atmosphere Data Store (ADS) Tutorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Read_Write.html">
   Import, Reduce, Export
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Visualisation Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="03_Maps.html">
   Maps
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_Animations.html">
   Animations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_Time_Series.html">
   Time Series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_Profile_Plot_Zonal_Mean.html">
   Profile Plots and Zonal Means
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Processing Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   European Air Quality Index Calculation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08_Ozone_Monitoring_Tutorial.html">
   Ozone Monitoring Tutorial
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Climate Data Processing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://ecmwf-projects.github.io/copernicus-training-c3s/">
   Tutorials from the Copernicus Climate Change Service (C3S)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/07_European_Air_Quality_Index_Calculation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ecmwf-projects/copernicus-training-cams"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/ecmwf-projects/copernicus-training-cams/issues/new?title=Issue%20on%20page%20%2F07_European_Air_Quality_Index_Calculation.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-cams/main?urlpath=tree/07_European_Air_Quality_Index_Calculation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about">
   About
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-is-the-european-air-quality-index-defined">
     How is the European Air Quality index defined?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data">
   Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#further-resources">
   Further resources
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-cdsapi-via-pip">
   Install CDSAPI via pip
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-libraries">
   Load libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-the-european-air-quality-index-for-europe-for-one-day-in-july-2021">
   1. Compute the European Air Quality Index for Europe for one day in July 2021
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#request-data-from-the-ads-programmatically-with-the-cds-api">
     1.1 Request data from the ADS programmatically with the CDS API
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-prepare-the-european-air-quality-forecast-data">
     1.2 Load and prepare the European air quality forecast data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-daily-maximum-concentration-values-into-european-air-quality-index-levels">
     1.3 Classify daily maximum concentration values into European Air Quality Index levels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-a-map-of-air-quality-index-levels-in-europe-for-15-july-2021">
     1.4 Visualize a map of Air Quality Index levels in Europe for 15 July 2021
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-the-daily-european-air-quality-index-for-london-in-december-2020">
   2. Calculate the daily European Air Quality Index for London in December 2020
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     2.1 Request data from the ADS programmatically with the CDS API
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     2.2 Load and prepare the European air quality forecast data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-time-series-information-for-london-uk-and-convert-to-a-pandas-dataframe">
     2.3 Select time-series information for London, UK and convert to a pandas dataframe
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-daily-maximum-values-of-key-pollutants-into-european-air-quality-index-levels">
     2.4 Classify daily maximum values of key pollutants into European Air Quality Index levels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-daily-european-air-quality-index-for-london-in-december-2020-as-heatmap">
     2.5 Visualize daily European Air Quality Index for London in December 2020 as heatmap
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>European Air Quality Index Calculation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about">
   About
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-is-the-european-air-quality-index-defined">
     How is the European Air Quality index defined?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data">
   Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#further-resources">
   Further resources
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#install-cdsapi-via-pip">
   Install CDSAPI via pip
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-libraries">
   Load libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compute-the-european-air-quality-index-for-europe-for-one-day-in-july-2021">
   1. Compute the European Air Quality Index for Europe for one day in July 2021
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#request-data-from-the-ads-programmatically-with-the-cds-api">
     1.1 Request data from the ADS programmatically with the CDS API
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-prepare-the-european-air-quality-forecast-data">
     1.2 Load and prepare the European air quality forecast data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-daily-maximum-concentration-values-into-european-air-quality-index-levels">
     1.3 Classify daily maximum concentration values into European Air Quality Index levels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-a-map-of-air-quality-index-levels-in-europe-for-15-july-2021">
     1.4 Visualize a map of Air Quality Index levels in Europe for 15 July 2021
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-the-daily-european-air-quality-index-for-london-in-december-2020">
   2. Calculate the daily European Air Quality Index for London in December 2020
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     2.1 Request data from the ADS programmatically with the CDS API
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     2.2 Load and prepare the European air quality forecast data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-time-series-information-for-london-uk-and-convert-to-a-pandas-dataframe">
     2.3 Select time-series information for London, UK and convert to a pandas dataframe
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-daily-maximum-values-of-key-pollutants-into-european-air-quality-index-levels">
     2.4 Classify daily maximum values of key pollutants into European Air Quality Index levels
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-daily-european-air-quality-index-for-london-in-december-2020-as-heatmap">
     2.5 Visualize daily European Air Quality Index for London in December 2020 as heatmap
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <p><img alt="logo" src="_images/LogoLine_horizon_CAMS.png" /></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p><a class="reference external" href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-cams/master?labpath=07_European_Air_Quality_Index_Calculation.ipynb"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a></p></td>
<td class="text-align:center"><p><a class="reference external" href="https://kaggle.com/kernels/welcome?src=https://github.com/ecmwf-projects/copernicus-training-cams/blob/master/07_European_Air_Quality_Index_Calculation.ipynb"><img alt="Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a></p></td>
<td class="text-align:center"><p><a class="reference external" href="https://colab.research.google.com/github/ecmwf-projects/copernicus-training-cams/blob/master/07_European_Air_Quality_Index_Calculation.ipynb"><img alt="Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p></td>
</tr>
</tbody>
</table>
<br><div class="tex2jax_ignore mathjax_ignore section" id="european-air-quality-index-calculation">
<h1>European Air Quality Index Calculation<a class="headerlink" href="#european-air-quality-index-calculation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="about">
<h2>About<a class="headerlink" href="#about" title="Permalink to this headline">¶</a></h2>
<p>This notebook provides you a practical introduction to the calculation and interpretation of the <code class="docutils literal notranslate"><span class="pre">Air</span> <span class="pre">Quality</span> <span class="pre">Index</span> <span class="pre">(AQI)</span></code> in Europe. Air pollution is the single largest environmental health risk in Europe, causing cardiovascular and respiratory diseases, that, in the most serious cases, lead to premature deaths.
The European Environment Agency’s European Air Quality Index allows users to understand more about air quality where they live. Even though the air quality in Europe has improved over recent decades, the levels of air pollutants still exceed EU standards and the most stringent World Health Organization (WHO) guidelines.</p>
<div class="section" id="how-is-the-european-air-quality-index-defined">
<h3>How is the European Air Quality index defined?<a class="headerlink" href="#how-is-the-european-air-quality-index-defined" title="Permalink to this headline">¶</a></h3>
<p>The European Air Quality index is computed for five main pollutants regulated in the European legislation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Ozone</span> <span class="pre">(O3)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nitrogen</span> <span class="pre">Dioxide</span> <span class="pre">(NO2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Sulphur</span> <span class="pre">Dioxide</span> <span class="pre">(SO2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Fine</span> <span class="pre">particulate</span> <span class="pre">matter</span> <span class="pre">with</span> <span class="pre">a</span> <span class="pre">diameter</span> <span class="pre">smaller</span> <span class="pre">than</span> <span class="pre">2.5</span> <span class="pre">micrometers</span> <span class="pre">(PM2.5)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Fine</span> <span class="pre">particulate</span> <span class="pre">matter</span> <span class="pre">with</span> <span class="pre">a</span> <span class="pre">diameter</span> <span class="pre">smaller</span> <span class="pre">than</span> <span class="pre">10</span> <span class="pre">micrometers</span> <span class="pre">(PM10)</span></code></p></li>
</ul>
<p>The index ranges from 1 (good) to 6 (extremely poor). For each pollutant, the index is calculated separately according to the concentrations; the higher the concentrations, the higher the index (see Table below for index levels). The overall hourly European Air Quality index is simply defined as the highest value of the five individual pollutants indexes computed for the same hour. For instance, if the indices relative to O<sub>3</sub>, NO<sub>2</sub>, SO<sub>2</sub>, PM2.5 and PM10 are 1,3,1,2,2 respectively, the overall index will be 3. The overall daily European Air Quality index is the highest value of the overall hourly European Air Quality index in the corresponding day.</p>
<p><img alt="logo" src="_images/eaqi_index_level.png" /></p>
<br><p>The notebook has the following outline:</p>
<ul class="simple">
<li><p>1 - Compute the European Air Quality Index for Europe for one day in July 2021</p>
<ul>
<li><p>1.1 - Request data from the ADS programmatically with the CDS API</p></li>
<li><p>1.2 - Load and prepare the European air quality forecast data</p></li>
<li><p>1.3 - Classify daily maximum pollutant values into European Air Quality Index levels</p></li>
<li><p>1.4 - Visualize a map of Air Quality Index levels in Europe for 15 July 2021</p></li>
</ul>
</li>
<li><p>2 - Calculate the daily European Air Quality Index for London in December 2020</p>
<ul>
<li><p>2.1 - Request data from the ADS programmatically with the CDS API</p></li>
<li><p>2.2 - Load and prepare the European air quality forecast data</p></li>
<li><p>2.3 - Select time-series information for London, UK and convert to a pandas dataframe</p></li>
<li><p>2.4 - Classify daily maximum values of key pollutants into European Air Quality Index levels</p></li>
<li><p>2.5 - Visualize daily European Air Quality Index for London in December 2020 as heatmap</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="data">
<h2>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces you to the <a class="reference external" href="(https://ads.atmosphere.copernicus.eu/cdsapp#%21/dataset/cams-europe-air-quality-forecasts?tab=overview)">CAMS European air quality forecasts and analysis</a> dataset. The data has the following specifications:</p>
<blockquote>
<div><p><strong>Data</strong>: <code class="docutils literal notranslate"><span class="pre">CAMS</span> <span class="pre">European</span> <span class="pre">air</span> <span class="pre">quality</span> <span class="pre">forecasts</span></code> <br>
<strong>Temporal coverage</strong>: <code class="docutils literal notranslate"><span class="pre">three-year</span> <span class="pre">rolling</span> <span class="pre">archive</span></code> <br>
<strong>Temporal resolution</strong>: <code class="docutils literal notranslate"><span class="pre">hourly</span></code> <br>
<strong>Spatial coverage</strong>: <code class="docutils literal notranslate"><span class="pre">Europe</span></code> <br>
<strong>Spatial resolution</strong>: <code class="docutils literal notranslate"><span class="pre">0.1°</span> <span class="pre">x</span> <span class="pre">0.1°</span></code> <br>
<strong>Format</strong>: <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code><br></p>
</div></blockquote>
</div>
<div class="section" id="further-resources">
<h2>Further resources<a class="headerlink" href="#further-resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.eea.europa.eu/themes/air">Air pollution - European Environment Agency</a></p></li>
<li><p><a class="reference external" href="https://www.eea.europa.eu/publications/air-quality-status-2021/air-quality-status-briefing-2021">Europe’s air quality status 2021</a></p></li>
<li><p><a class="reference external" href="https://www.eea.europa.eu/highlights/air-pollution-still-too-high-1">Air pollution stil too high in most EU Member States</a></p></li>
<li><p><a class="reference external" href="https://www.euronews.com/weather/copernicus-air-quality-index">Euronews: Copernicus air quality index</a></p></li>
</ul>
<hr></div>
<div class="section" id="install-cdsapi-via-pip">
<h2>Install CDSAPI via pip<a class="headerlink" href="#install-cdsapi-via-pip" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install cdsapi
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: cdsapi in /Volumes/gdrive/cop_consultancy/venv310/lib/python3.10/site-packages (0.5.1)
Requirement already satisfied: requests&gt;=2.5.0 in /Volumes/gdrive/cop_consultancy/venv310/lib/python3.10/site-packages (from cdsapi) (2.26.0)
Requirement already satisfied: tqdm in /Volumes/gdrive/cop_consultancy/venv310/lib/python3.10/site-packages (from cdsapi) (4.62.3)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /Volumes/gdrive/cop_consultancy/venv310/lib/python3.10/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (1.26.7)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /Volumes/gdrive/cop_consultancy/venv310/lib/python3.10/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (3.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /Volumes/gdrive/cop_consultancy/venv310/lib/python3.10/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (2021.10.8)
Requirement already satisfied: charset-normalizer~=2.0.0 in /Volumes/gdrive/cop_consultancy/venv310/lib/python3.10/site-packages (from requests&gt;=2.5.0-&gt;cdsapi) (2.0.7)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-libraries">
<h2>Load libraries<a class="headerlink" href="#load-libraries" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CDS API</span>
<span class="kn">import</span> <span class="nn">cdsapi</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Libraries for working with multi-dimensional arrays</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Libraries for plotting and visualising data</span>
<span class="kn">import</span> <span class="nn">matplotlib.path</span> <span class="k">as</span> <span class="nn">mpath</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">animation</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<hr></div>
<div class="section" id="compute-the-european-air-quality-index-for-europe-for-one-day-in-july-2021">
<h2>1. Compute the European Air Quality Index for Europe for one day in July 2021<a class="headerlink" href="#compute-the-european-air-quality-index-for-europe-for-one-day-in-july-2021" title="Permalink to this headline">¶</a></h2>
<p>As a first example, we want to compute and visualize the European Air Quality Index for Europe for one day in July 2021.</p>
<div class="section" id="request-data-from-the-ads-programmatically-with-the-cds-api">
<h3>1.1 Request data from the ADS programmatically with the CDS API<a class="headerlink" href="#request-data-from-the-ads-programmatically-with-the-cds-api" title="Permalink to this headline">¶</a></h3>
<p>Let us request data from the Atmosphere Data Store programmatically with the help of the CDS API. Let us set manually the CDS API credentials. First, you have to define two variables: <code class="docutils literal notranslate"><span class="pre">URL</span></code> and <code class="docutils literal notranslate"><span class="pre">KEY</span></code> which build together your CDS API key. Below, you have to replace the <code class="docutils literal notranslate"><span class="pre">#########</span></code> with your personal ADS key. Please find <a class="reference external" href="https://ads.atmosphere.copernicus.eu/api-how-to">here</a> your personal ADS key.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://ads.atmosphere.copernicus.eu/api/v2&#39;</span>
<span class="n">KEY</span> <span class="o">=</span> <span class="s1">&#39;######################################&#39;</span>
</pre></div>
</div>
</div>
</div>
<br><p>The next step is then to request the data with the help of the CDS API. Below, we request analysis data from the <code class="docutils literal notranslate"><span class="pre">CAMS</span> <span class="pre">European</span> <span class="pre">air</span> <span class="pre">quality</span> <span class="pre">forecasts</span></code> dataset. We request hourly data for 15 July 2021 for the five main pollutants for which the European Air Quality Index is calculated: <code class="docutils literal notranslate"><span class="pre">nitrogen_dioxide</span></code>, <code class="docutils literal notranslate"><span class="pre">ozone</span></code>, <code class="docutils literal notranslate"><span class="pre">particulate_matter_10um</span></code>, <code class="docutils literal notranslate"><span class="pre">particulate_matter_2.5um</span></code> and <code class="docutils literal notranslate"><span class="pre">sulphur_dioxide</span></code>.</p>
<p>Let us store the dataset under the name <code class="docutils literal notranslate"><span class="pre">20210715_eaqi_europe.nc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cdsapi</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;cams-europe-air-quality-forecasts&#39;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;euradim&#39;</span><span class="p">,</span>
        <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;2021-07-15/2021-07-15&#39;</span><span class="p">,</span>
        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;analysis&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;01:00&#39;</span><span class="p">,</span> <span class="s1">&#39;02:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;03:00&#39;</span><span class="p">,</span> <span class="s1">&#39;04:00&#39;</span><span class="p">,</span> <span class="s1">&#39;05:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;06:00&#39;</span><span class="p">,</span> <span class="s1">&#39;07:00&#39;</span><span class="p">,</span> <span class="s1">&#39;08:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;09:00&#39;</span><span class="p">,</span> <span class="s1">&#39;10:00&#39;</span><span class="p">,</span> <span class="s1">&#39;11:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;12:00&#39;</span><span class="p">,</span> <span class="s1">&#39;13:00&#39;</span><span class="p">,</span> <span class="s1">&#39;14:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;15:00&#39;</span><span class="p">,</span> <span class="s1">&#39;16:00&#39;</span><span class="p">,</span> <span class="s1">&#39;17:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;18:00&#39;</span><span class="p">,</span> <span class="s1">&#39;19:00&#39;</span><span class="p">,</span> <span class="s1">&#39;20:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;21:00&#39;</span><span class="p">,</span> <span class="s1">&#39;22:00&#39;</span><span class="p">,</span> <span class="s1">&#39;23:00&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;leadtime_hour&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;nitrogen_dioxide&#39;</span><span class="p">,</span> <span class="s1">&#39;ozone&#39;</span><span class="p">,</span> <span class="s1">&#39;particulate_matter_10um&#39;</span><span class="p">,</span>
            <span class="s1">&#39;particulate_matter_2.5um&#39;</span><span class="p">,</span> <span class="s1">&#39;sulphur_dioxide&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;./20210715_eaqi_europe.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<br></div>
<div class="section" id="load-and-prepare-the-european-air-quality-forecast-data">
<h3>1.2 Load and prepare the European air quality forecast data<a class="headerlink" href="#load-and-prepare-the-european-air-quality-forecast-data" title="Permalink to this headline">¶</a></h3>
<p>The European air quality forecast data are available either in <code class="docutils literal notranslate"><span class="pre">GRIB</span></code> or in <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code> format. Above, we requested the data in the <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code> format. You can use the Python library <a class="reference external" href="http://xarray.pydata.org/en/stable/">xarray</a> and the function <code class="docutils literal notranslate"><span class="pre">open_dataset()</span></code> to load a NetCDF file as <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>. A xarray Dataset is a collection of one or more variables that share the same dimensions. Below, you see that the Dataset has four dimensions, <code class="docutils literal notranslate"><span class="pre">latitude</span></code>, <code class="docutils literal notranslate"><span class="pre">level</span></code>, <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>, and five variables, <code class="docutils literal notranslate"><span class="pre">no2_conc</span></code>, <code class="docutils literal notranslate"><span class="pre">o3_conc</span></code>, <code class="docutils literal notranslate"><span class="pre">pm10_conc</span></code>, <code class="docutils literal notranslate"><span class="pre">pm2p5_conc</span></code> and <code class="docutils literal notranslate"><span class="pre">so2_conc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;./20210715_eaqi_europe.nc&#39;</span><span class="p">)</span>
<span class="n">eaqi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 420, level: 1, longitude: 700, time: 24)
Coordinates:
  * longitude   (longitude) float32 335.0 335.1 335.2 ... 44.75 44.85 44.95
  * latitude    (latitude) float32 71.95 71.85 71.75 71.65 ... 30.25 30.15 30.05
  * level       (level) float32 0.0
  * time        (time) timedelta64[ns] 00:00:00 01:00:00 ... 22:00:00 23:00:00
Data variables:
    no2_conc    (time, level, latitude, longitude) float32 ...
    o3_conc     (time, level, latitude, longitude) float32 ...
    pm10_conc   (time, level, latitude, longitude) float32 ...
    pm2p5_conc  (time, level, latitude, longitude) float32 ...
    so2_conc    (time, level, latitude, longitude) float32 ...
Attributes:
    title:        NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface
    institution:  Data produced by RIUUK
    source:       Data from EURAD-IM model
    history:      Model EURAD ANALYSIS
    ANALYSIS:     Europe, 20210715+[0H_23H]
    summary:      EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concent...
    project:      MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-aa2aa59c-26d4-44c6-96d1-8471bd0fe998' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-aa2aa59c-26d4-44c6-96d1-8471bd0fe998' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 420</li><li><span class='xr-has-index'>level</span>: 1</li><li><span class='xr-has-index'>longitude</span>: 700</li><li><span class='xr-has-index'>time</span>: 24</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b70736dc-36d3-4b78-93f5-6051e615d7e1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b70736dc-36d3-4b78-93f5-6051e615d7e1' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>335.0 335.1 335.2 ... 44.85 44.95</div><input id='attrs-9d09b10a-2f52-4b88-ad8b-b1082a32fc4c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9d09b10a-2f52-4b88-ad8b-b1082a32fc4c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa6be47d-bf88-4bcc-a014-6b73f0a12f1e' class='xr-var-data-in' type='checkbox'><label for='data-fa6be47d-bf88-4bcc-a014-6b73f0a12f1e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([335.05, 335.15, 335.25, ...,  44.75,  44.85,  44.95], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>71.95 71.85 71.75 ... 30.15 30.05</div><input id='attrs-d123e809-3ed6-4f0f-bc42-3b29b0fdb2f6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d123e809-3ed6-4f0f-bc42-3b29b0fdb2f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af13e153-ac7f-49c5-81c1-b0c5963a8a1c' class='xr-var-data-in' type='checkbox'><label for='data-af13e153-ac7f-49c5-81c1-b0c5963a8a1c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([71.95, 71.85, 71.75, ..., 30.25, 30.15, 30.05], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-ce3e449c-d51c-4dd2-b007-cc049c86ead6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ce3e449c-d51c-4dd2-b007-cc049c86ead6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-05749409-c90f-47d0-8db5-32623f7b593f' class='xr-var-data-in' type='checkbox'><label for='data-05749409-c90f-47d0-8db5-32623f7b593f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>timedelta64[ns]</div><div class='xr-var-preview xr-preview'>00:00:00 01:00:00 ... 23:00:00</div><input id='attrs-ea05ec71-b56d-446d-a195-43f44cc2af93' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ea05ec71-b56d-446d-a195-43f44cc2af93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-138df0df-d8a5-405b-ab1d-a0e781cd524d' class='xr-var-data-in' type='checkbox'><label for='data-138df0df-d8a5-405b-ab1d-a0e781cd524d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ANALYSIS time from 20210715</dd></dl></div><div class='xr-var-data'><pre>array([             0,  3600000000000,  7200000000000, 10800000000000,
       14400000000000, 18000000000000, 21600000000000, 25200000000000,
       28800000000000, 32400000000000, 36000000000000, 39600000000000,
       43200000000000, 46800000000000, 50400000000000, 54000000000000,
       57600000000000, 61200000000000, 64800000000000, 68400000000000,
       72000000000000, 75600000000000, 79200000000000, 82800000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-12438c6f-ae92-4309-92e3-ae7379957ac3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-12438c6f-ae92-4309-92e3-ae7379957ac3' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-80196d2f-fb67-4df6-80e7-97551428a82f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-80196d2f-fb67-4df6-80e7-97551428a82f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0f1d4ae-c3d0-4656-866b-42f6c9eba0ef' class='xr-var-data-in' type='checkbox'><label for='data-d0f1d4ae-c3d0-4656-866b-42f6c9eba0ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Nitrogen Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_nitrogen_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e3144d0e-bb15-48b4-a232-03db108abb92' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e3144d0e-bb15-48b4-a232-03db108abb92' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1f66cb95-90f4-4615-bb98-88e7a6a92205' class='xr-var-data-in' type='checkbox'><label for='data-1f66cb95-90f4-4615-bb98-88e7a6a92205' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Ozone</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_ozone_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ce8f2aff-6b9b-494f-830d-77cb960aec9c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ce8f2aff-6b9b-494f-830d-77cb960aec9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-43f4af9b-5df2-4a9d-b8c8-3329b43228c8' class='xr-var-data-in' type='checkbox'><label for='data-43f4af9b-5df2-4a9d-b8c8-3329b43228c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM10 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a3caf315-8621-4400-b358-3ec9b04dc179' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a3caf315-8621-4400-b358-3ec9b04dc179' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7ee3f82c-7589-40c0-a184-5aef7d3c0d27' class='xr-var-data-in' type='checkbox'><label for='data-7ee3f82c-7589-40c0-a184-5aef7d3c0d27' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM2.5 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c6265412-a4fe-4b8a-9df7-9d6da3900be6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c6265412-a4fe-4b8a-9df7-9d6da3900be6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cfac6109-12c8-4ee7-8274-931aebee0d6c' class='xr-var-data-in' type='checkbox'><label for='data-cfac6109-12c8-4ee7-8274-931aebee0d6c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Sulphur Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_sulfur_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7f7efd58-c7ef-4eca-9a9d-7a5aea19412a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7f7efd58-c7ef-4eca-9a9d-7a5aea19412a' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface</dd><dt><span>institution :</span></dt><dd>Data produced by RIUUK</dd><dt><span>source :</span></dt><dd>Data from EURAD-IM model</dd><dt><span>history :</span></dt><dd>Model EURAD ANALYSIS</dd><dt><span>ANALYSIS :</span></dt><dd>Europe, 20210715+[0H_23H]</dd><dt><span>summary :</span></dt><dd>EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concentration at the Surface from 20210715+[0H_23H] on Europe</dd><dt><span>project :</span></dt><dd>MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</dd></dl></div></li></ul></div></div></div></div>
</div>
<br><p>Let us have a closer look at the coordinates of the dataset. You see above that the dataset consists of 24 time steps and that the longitude values are on a [0, 360] grid.</p>
<p>However, if you inspect the time dimension more in detail, you see that the time is given in nanoseconds [ns]. Hence, as a next step, let us convert the time information into a human-readable time format and bring the longitude coordinates to a [-180, 180] grid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;time&#x27; (time: 24)&gt;
array([             0,  3600000000000,  7200000000000, 10800000000000,
       14400000000000, 18000000000000, 21600000000000, 25200000000000,
       28800000000000, 32400000000000, 36000000000000, 39600000000000,
       43200000000000, 46800000000000, 50400000000000, 54000000000000,
       57600000000000, 61200000000000, 64800000000000, 68400000000000,
       72000000000000, 75600000000000, 79200000000000, 82800000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)
Coordinates:
  * time     (time) timedelta64[ns] 00:00:00 01:00:00 ... 22:00:00 23:00:00
Attributes:
    long_name:  ANALYSIS time from 20210715</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'time'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 24</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e2b1c4d5-e5b9-4e73-844d-bae393a8a529' class='xr-array-in' type='checkbox' checked><label for='section-e2b1c4d5-e5b9-4e73-844d-bae393a8a529' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>00:00:00 01:00:00 02:00:00 03:00:00 ... 21:00:00 22:00:00 23:00:00</span></div><div class='xr-array-data'><pre>array([             0,  3600000000000,  7200000000000, 10800000000000,
       14400000000000, 18000000000000, 21600000000000, 25200000000000,
       28800000000000, 32400000000000, 36000000000000, 39600000000000,
       43200000000000, 46800000000000, 50400000000000, 54000000000000,
       57600000000000, 61200000000000, 64800000000000, 68400000000000,
       72000000000000, 75600000000000, 79200000000000, 82800000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)</pre></div></div></li><li class='xr-section-item'><input id='section-3a056a7a-7408-4c8d-8bda-c945a6f720cb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3a056a7a-7408-4c8d-8bda-c945a6f720cb' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>timedelta64[ns]</div><div class='xr-var-preview xr-preview'>00:00:00 01:00:00 ... 23:00:00</div><input id='attrs-86893441-ea3d-4bbf-89a3-5707284487a3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-86893441-ea3d-4bbf-89a3-5707284487a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-daf45c2c-edf4-43d6-a5fe-454d073849c4' class='xr-var-data-in' type='checkbox'><label for='data-daf45c2c-edf4-43d6-a5fe-454d073849c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ANALYSIS time from 20210715</dd></dl></div><div class='xr-var-data'><pre>array([             0,  3600000000000,  7200000000000, 10800000000000,
       14400000000000, 18000000000000, 21600000000000, 25200000000000,
       28800000000000, 32400000000000, 36000000000000, 39600000000000,
       43200000000000, 46800000000000, 50400000000000, 54000000000000,
       57600000000000, 61200000000000, 64800000000000, 68400000000000,
       72000000000000, 75600000000000, 79200000000000, 82800000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-03cfd8f9-5eea-4c60-a9e0-d9ceb217f4b8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-03cfd8f9-5eea-4c60-a9e0-d9ceb217f4b8' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ANALYSIS time from 20210715</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>First, from the <code class="docutils literal notranslate"><span class="pre">long_name</span></code> information of the time dimension (see above), we can retrieve the initial timestamp. With the function <code class="docutils literal notranslate"><span class="pre">strptime()</span></code> from Python’s <code class="docutils literal notranslate"><span class="pre">datetime</span></code> library, we can convert it into a <code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">eaqi</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">long_name</span><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">]</span>

<span class="n">timestamp_init</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="p">)</span>
<span class="n">timestamp_init</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2021, 7, 15, 0, 0)
</pre></div>
</div>
</div>
</div>
<p>In a next step, we then build a <code class="docutils literal notranslate"><span class="pre">DateTimeIndex</span></code> object with the help of Panda’s <code class="docutils literal notranslate"><span class="pre">date_range()</span></code> function, making use of the length of the time dimension. The result is a <code class="docutils literal notranslate"><span class="pre">DateTimeIndex</span></code> object, which can be used to newly assign the time coordinate information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_coords</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">timestamp_init</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">eaqi</span><span class="o">.</span><span class="n">time</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;1h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">)</span>
<span class="n">time_coords</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2021-07-15 00:00:00&#39;, &#39;2021-07-15 01:00:00&#39;,
               &#39;2021-07-15 02:00:00&#39;, &#39;2021-07-15 03:00:00&#39;,
               &#39;2021-07-15 04:00:00&#39;, &#39;2021-07-15 05:00:00&#39;,
               &#39;2021-07-15 06:00:00&#39;, &#39;2021-07-15 07:00:00&#39;,
               &#39;2021-07-15 08:00:00&#39;, &#39;2021-07-15 09:00:00&#39;,
               &#39;2021-07-15 10:00:00&#39;, &#39;2021-07-15 11:00:00&#39;,
               &#39;2021-07-15 12:00:00&#39;, &#39;2021-07-15 13:00:00&#39;,
               &#39;2021-07-15 14:00:00&#39;, &#39;2021-07-15 15:00:00&#39;,
               &#39;2021-07-15 16:00:00&#39;, &#39;2021-07-15 17:00:00&#39;,
               &#39;2021-07-15 18:00:00&#39;, &#39;2021-07-15 19:00:00&#39;,
               &#39;2021-07-15 20:00:00&#39;, &#39;2021-07-15 21:00:00&#39;,
               &#39;2021-07-15 22:00:00&#39;, &#39;2021-07-15 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, freq=None)
</pre></div>
</div>
</div>
</div>
<p>And the last step is to assign the converted time information to the loaded xarray.Dataset <code class="docutils literal notranslate"><span class="pre">eaqi</span></code>, with the function <code class="docutils literal notranslate"><span class="pre">assign_coords()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_assigned</span> <span class="o">=</span> <span class="n">eaqi</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_coords</span><span class="p">)</span>
<span class="n">eaqi_assigned</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 420, level: 1, longitude: 700, time: 24)
Coordinates:
  * longitude   (longitude) float32 335.0 335.1 335.2 ... 44.75 44.85 44.95
  * latitude    (latitude) float32 71.95 71.85 71.75 71.65 ... 30.25 30.15 30.05
  * level       (level) float32 0.0
  * time        (time) datetime64[ns] 2021-07-15 ... 2021-07-15T23:00:00
Data variables:
    no2_conc    (time, level, latitude, longitude) float32 ...
    o3_conc     (time, level, latitude, longitude) float32 ...
    pm10_conc   (time, level, latitude, longitude) float32 ...
    pm2p5_conc  (time, level, latitude, longitude) float32 ...
    so2_conc    (time, level, latitude, longitude) float32 ...
Attributes:
    title:        NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface
    institution:  Data produced by RIUUK
    source:       Data from EURAD-IM model
    history:      Model EURAD ANALYSIS
    ANALYSIS:     Europe, 20210715+[0H_23H]
    summary:      EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concent...
    project:      MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-14ec6e37-2fb0-4de9-b9e7-e5fef0e0ed5c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-14ec6e37-2fb0-4de9-b9e7-e5fef0e0ed5c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 420</li><li><span class='xr-has-index'>level</span>: 1</li><li><span class='xr-has-index'>longitude</span>: 700</li><li><span class='xr-has-index'>time</span>: 24</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-36b5b2ff-d14e-4e46-a376-797ae08bcbec' class='xr-section-summary-in' type='checkbox'  checked><label for='section-36b5b2ff-d14e-4e46-a376-797ae08bcbec' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>335.0 335.1 335.2 ... 44.85 44.95</div><input id='attrs-b0fcd791-52b0-4c57-862d-852541513d41' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b0fcd791-52b0-4c57-862d-852541513d41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-06e5963d-83b7-4edc-ae15-b46509907b20' class='xr-var-data-in' type='checkbox'><label for='data-06e5963d-83b7-4edc-ae15-b46509907b20' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([335.05, 335.15, 335.25, ...,  44.75,  44.85,  44.95], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>71.95 71.85 71.75 ... 30.15 30.05</div><input id='attrs-981528fd-5f18-43ee-a3ab-54993940a3cb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-981528fd-5f18-43ee-a3ab-54993940a3cb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57341051-7d99-48fc-81b0-531e733b18d7' class='xr-var-data-in' type='checkbox'><label for='data-57341051-7d99-48fc-81b0-531e733b18d7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([71.95, 71.85, 71.75, ..., 30.25, 30.15, 30.05], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-f428708e-c29f-4b05-a652-8a62462da89b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f428708e-c29f-4b05-a652-8a62462da89b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a095b43-80db-41ca-851f-70c186265bc5' class='xr-var-data-in' type='checkbox'><label for='data-7a095b43-80db-41ca-851f-70c186265bc5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-07-15 ... 2021-07-15T23:00:00</div><input id='attrs-94c3bc93-f17b-46ec-8d9b-86ef3e4902e6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-94c3bc93-f17b-46ec-8d9b-86ef3e4902e6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de5bc16e-dafd-478f-ab11-dddc3e459e01' class='xr-var-data-in' type='checkbox'><label for='data-de5bc16e-dafd-478f-ab11-dddc3e459e01' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-07-15T00:00:00.000000000&#x27;, &#x27;2021-07-15T01:00:00.000000000&#x27;,
       &#x27;2021-07-15T02:00:00.000000000&#x27;, &#x27;2021-07-15T03:00:00.000000000&#x27;,
       &#x27;2021-07-15T04:00:00.000000000&#x27;, &#x27;2021-07-15T05:00:00.000000000&#x27;,
       &#x27;2021-07-15T06:00:00.000000000&#x27;, &#x27;2021-07-15T07:00:00.000000000&#x27;,
       &#x27;2021-07-15T08:00:00.000000000&#x27;, &#x27;2021-07-15T09:00:00.000000000&#x27;,
       &#x27;2021-07-15T10:00:00.000000000&#x27;, &#x27;2021-07-15T11:00:00.000000000&#x27;,
       &#x27;2021-07-15T12:00:00.000000000&#x27;, &#x27;2021-07-15T13:00:00.000000000&#x27;,
       &#x27;2021-07-15T14:00:00.000000000&#x27;, &#x27;2021-07-15T15:00:00.000000000&#x27;,
       &#x27;2021-07-15T16:00:00.000000000&#x27;, &#x27;2021-07-15T17:00:00.000000000&#x27;,
       &#x27;2021-07-15T18:00:00.000000000&#x27;, &#x27;2021-07-15T19:00:00.000000000&#x27;,
       &#x27;2021-07-15T20:00:00.000000000&#x27;, &#x27;2021-07-15T21:00:00.000000000&#x27;,
       &#x27;2021-07-15T22:00:00.000000000&#x27;, &#x27;2021-07-15T23:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4dc32d29-ee6c-490a-aee8-21ae13c6fc7f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4dc32d29-ee6c-490a-aee8-21ae13c6fc7f' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f5d48a0c-fbc9-4700-bb1b-253e1a805eef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f5d48a0c-fbc9-4700-bb1b-253e1a805eef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-336d14b1-142a-4980-888c-79bfbd283f47' class='xr-var-data-in' type='checkbox'><label for='data-336d14b1-142a-4980-888c-79bfbd283f47' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Nitrogen Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_nitrogen_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-264b25c3-c5eb-408e-8072-7c561bf78e1d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-264b25c3-c5eb-408e-8072-7c561bf78e1d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dbc29819-b511-4cdc-844f-cb1dd9d67147' class='xr-var-data-in' type='checkbox'><label for='data-dbc29819-b511-4cdc-844f-cb1dd9d67147' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Ozone</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_ozone_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-fc50b146-1c28-4bd7-b652-c7d00e99de16' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fc50b146-1c28-4bd7-b652-c7d00e99de16' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a635f054-50ba-4aed-9b5f-e68fee49e8a5' class='xr-var-data-in' type='checkbox'><label for='data-a635f054-50ba-4aed-9b5f-e68fee49e8a5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM10 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f038c757-404c-4c42-a557-a7d30da34dc8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f038c757-404c-4c42-a557-a7d30da34dc8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ef762b1-6ff9-4b0c-b650-24520569db3f' class='xr-var-data-in' type='checkbox'><label for='data-9ef762b1-6ff9-4b0c-b650-24520569db3f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM2.5 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1edee6b3-d8f8-47ea-bbf9-97a74d459739' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1edee6b3-d8f8-47ea-bbf9-97a74d459739' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-afda9d3f-ff16-40bf-bd72-6e00e5c60e1a' class='xr-var-data-in' type='checkbox'><label for='data-afda9d3f-ff16-40bf-bd72-6e00e5c60e1a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Sulphur Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_sulfur_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1c7f7371-81c9-47a9-a3ac-1462ba96bb07' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1c7f7371-81c9-47a9-a3ac-1462ba96bb07' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface</dd><dt><span>institution :</span></dt><dd>Data produced by RIUUK</dd><dt><span>source :</span></dt><dd>Data from EURAD-IM model</dd><dt><span>history :</span></dt><dd>Model EURAD ANALYSIS</dd><dt><span>ANALYSIS :</span></dt><dd>Europe, 20210715+[0H_23H]</dd><dt><span>summary :</span></dt><dd>EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concentration at the Surface from 20210715+[0H_23H] on Europe</dd><dt><span>project :</span></dt><dd>MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</dd></dl></div></li></ul></div></div></div></div>
</div>
<br><p>Now, let us also re-assign the longitude values and shift the grid from [0,360] to [-180,180]. At the end, you might want to sort the longitude values in an ascending order. You can re-assign coordinate values with the xarray function <code class="docutils literal notranslate"><span class="pre">assign_coords()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_assigned</span> <span class="o">=</span> <span class="n">eaqi_assigned</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="p">(((</span><span class="n">eaqi_assigned</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span><span class="p">))</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
<span class="n">eaqi_assigned</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 420, level: 1, longitude: 700, time: 24)
Coordinates:
  * longitude   (longitude) float32 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude    (latitude) float32 71.95 71.85 71.75 71.65 ... 30.25 30.15 30.05
  * level       (level) float32 0.0
  * time        (time) datetime64[ns] 2021-07-15 ... 2021-07-15T23:00:00
Data variables:
    no2_conc    (time, level, latitude, longitude) float32 ...
    o3_conc     (time, level, latitude, longitude) float32 ...
    pm10_conc   (time, level, latitude, longitude) float32 ...
    pm2p5_conc  (time, level, latitude, longitude) float32 ...
    so2_conc    (time, level, latitude, longitude) float32 ...
Attributes:
    title:        NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface
    institution:  Data produced by RIUUK
    source:       Data from EURAD-IM model
    history:      Model EURAD ANALYSIS
    ANALYSIS:     Europe, 20210715+[0H_23H]
    summary:      EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concent...
    project:      MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8d490354-dae2-4819-b0ba-796f6207222d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8d490354-dae2-4819-b0ba-796f6207222d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 420</li><li><span class='xr-has-index'>level</span>: 1</li><li><span class='xr-has-index'>longitude</span>: 700</li><li><span class='xr-has-index'>time</span>: 24</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-46546b72-35e2-4df4-b215-b0a334506961' class='xr-section-summary-in' type='checkbox'  checked><label for='section-46546b72-35e2-4df4-b215-b0a334506961' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-a4f950e8-b6d0-4541-918e-44c495369053' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a4f950e8-b6d0-4541-918e-44c495369053' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d386bfea-2665-49c3-9327-d171cbcfa644' class='xr-var-data-in' type='checkbox'><label for='data-d386bfea-2665-49c3-9327-d171cbcfa644' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.849976, -24.75    , ...,  44.75    ,  44.850006,
        44.949997], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>71.95 71.85 71.75 ... 30.15 30.05</div><input id='attrs-a23c53c7-c475-43cc-a43d-448a616c562f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a23c53c7-c475-43cc-a43d-448a616c562f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e91cfcb8-0ae4-483b-979a-c75bf4d11cd7' class='xr-var-data-in' type='checkbox'><label for='data-e91cfcb8-0ae4-483b-979a-c75bf4d11cd7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([71.95, 71.85, 71.75, ..., 30.25, 30.15, 30.05], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-7263db9f-e2b7-4f82-9cff-7ab387a306e7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7263db9f-e2b7-4f82-9cff-7ab387a306e7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-473fd981-a94c-44b2-acee-eddc491ac71a' class='xr-var-data-in' type='checkbox'><label for='data-473fd981-a94c-44b2-acee-eddc491ac71a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-07-15 ... 2021-07-15T23:00:00</div><input id='attrs-d9e34a60-a23a-4bfc-8ef4-a315599369e0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d9e34a60-a23a-4bfc-8ef4-a315599369e0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8bb8f72e-cfa4-47c1-b7b4-26bb2b023e25' class='xr-var-data-in' type='checkbox'><label for='data-8bb8f72e-cfa4-47c1-b7b4-26bb2b023e25' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-07-15T00:00:00.000000000&#x27;, &#x27;2021-07-15T01:00:00.000000000&#x27;,
       &#x27;2021-07-15T02:00:00.000000000&#x27;, &#x27;2021-07-15T03:00:00.000000000&#x27;,
       &#x27;2021-07-15T04:00:00.000000000&#x27;, &#x27;2021-07-15T05:00:00.000000000&#x27;,
       &#x27;2021-07-15T06:00:00.000000000&#x27;, &#x27;2021-07-15T07:00:00.000000000&#x27;,
       &#x27;2021-07-15T08:00:00.000000000&#x27;, &#x27;2021-07-15T09:00:00.000000000&#x27;,
       &#x27;2021-07-15T10:00:00.000000000&#x27;, &#x27;2021-07-15T11:00:00.000000000&#x27;,
       &#x27;2021-07-15T12:00:00.000000000&#x27;, &#x27;2021-07-15T13:00:00.000000000&#x27;,
       &#x27;2021-07-15T14:00:00.000000000&#x27;, &#x27;2021-07-15T15:00:00.000000000&#x27;,
       &#x27;2021-07-15T16:00:00.000000000&#x27;, &#x27;2021-07-15T17:00:00.000000000&#x27;,
       &#x27;2021-07-15T18:00:00.000000000&#x27;, &#x27;2021-07-15T19:00:00.000000000&#x27;,
       &#x27;2021-07-15T20:00:00.000000000&#x27;, &#x27;2021-07-15T21:00:00.000000000&#x27;,
       &#x27;2021-07-15T22:00:00.000000000&#x27;, &#x27;2021-07-15T23:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f0120029-b68a-47e7-a4a2-3e2ff0c5952b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f0120029-b68a-47e7-a4a2-3e2ff0c5952b' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-38f8cc05-0753-40e4-86de-05ac48ee75a2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-38f8cc05-0753-40e4-86de-05ac48ee75a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c7064098-ac79-4aef-a0b1-978e9724a36e' class='xr-var-data-in' type='checkbox'><label for='data-c7064098-ac79-4aef-a0b1-978e9724a36e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Nitrogen Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_nitrogen_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-04ad6df7-ba39-4758-b1b2-38f0a571f734' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-04ad6df7-ba39-4758-b1b2-38f0a571f734' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0a50a7aa-4444-46b7-94cc-1dbfd2e53d95' class='xr-var-data-in' type='checkbox'><label for='data-0a50a7aa-4444-46b7-94cc-1dbfd2e53d95' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Ozone</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_ozone_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-21ecd526-21a3-4202-963b-7e577160428c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-21ecd526-21a3-4202-963b-7e577160428c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f8dc7700-736f-414e-8a07-3b10d9680ec5' class='xr-var-data-in' type='checkbox'><label for='data-f8dc7700-736f-414e-8a07-3b10d9680ec5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM10 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-dd4f9cd3-2ad4-4d7a-a2b8-a19c5fc3b7b6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dd4f9cd3-2ad4-4d7a-a2b8-a19c5fc3b7b6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7c4c14c-b46f-48b8-b46d-024426fe13f4' class='xr-var-data-in' type='checkbox'><label for='data-b7c4c14c-b46f-48b8-b46d-024426fe13f4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM2.5 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8d829731-d88d-4bac-8c39-43d125157710' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8d829731-d88d-4bac-8c39-43d125157710' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-362d108d-a068-4f6a-b781-76255a41763e' class='xr-var-data-in' type='checkbox'><label for='data-362d108d-a068-4f6a-b781-76255a41763e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Sulphur Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_sulfur_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>[7056000 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9d3cece4-b375-4fd9-afc6-fb5fd3984eca' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9d3cece4-b375-4fd9-afc6-fb5fd3984eca' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface</dd><dt><span>institution :</span></dt><dd>Data produced by RIUUK</dd><dt><span>source :</span></dt><dd>Data from EURAD-IM model</dd><dt><span>history :</span></dt><dd>Model EURAD ANALYSIS</dd><dt><span>ANALYSIS :</span></dt><dd>Europe, 20210715+[0H_23H]</dd><dt><span>summary :</span></dt><dd>EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concentration at the Surface from 20210715+[0H_23H] on Europe</dd><dt><span>project :</span></dt><dd>MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</dd></dl></div></li></ul></div></div></div></div>
</div>
<br><p>Let us now also resample the hourly concentrations of the five pollutants and extract for each pollutant the maximum value for each day. The result is that the Dataset remains with only one entry of the time dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_daily</span> <span class="o">=</span> <span class="n">eaqi_assigned</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">eaqi_daily</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 420, level: 1, longitude: 700, time: 1)
Coordinates:
  * time        (time) datetime64[ns] 2021-07-15
  * longitude   (longitude) float32 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude    (latitude) float32 71.95 71.85 71.75 71.65 ... 30.25 30.15 30.05
  * level       (level) float32 0.0
Data variables:
    no2_conc    (time, level, latitude, longitude) float32 0.02787 ... 3.931
    o3_conc     (time, level, latitude, longitude) float32 61.97 61.97 ... 125.3
    pm10_conc   (time, level, latitude, longitude) float32 0.7773 ... 52.61
    pm2p5_conc  (time, level, latitude, longitude) float32 0.5984 ... 30.76
    so2_conc    (time, level, latitude, longitude) float32 0.001265 ... 22.91</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-20b123c0-d84a-4820-8592-3f3e92119cb6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-20b123c0-d84a-4820-8592-3f3e92119cb6' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 420</li><li><span class='xr-has-index'>level</span>: 1</li><li><span class='xr-has-index'>longitude</span>: 700</li><li><span class='xr-has-index'>time</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-45737d7d-78b3-4f2a-b49d-b03a00e10312' class='xr-section-summary-in' type='checkbox'  checked><label for='section-45737d7d-78b3-4f2a-b49d-b03a00e10312' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-07-15</div><input id='attrs-0aee6627-d303-4a6b-84f1-4fa6ab45d3a8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0aee6627-d303-4a6b-84f1-4fa6ab45d3a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a1d07658-0558-4377-9f0a-f31324fc45b9' class='xr-var-data-in' type='checkbox'><label for='data-a1d07658-0558-4377-9f0a-f31324fc45b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-07-15T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-1b141d2e-66e6-430a-b04d-6fc463ea50bf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1b141d2e-66e6-430a-b04d-6fc463ea50bf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2345021f-2600-4591-a5ed-34cee5e53a49' class='xr-var-data-in' type='checkbox'><label for='data-2345021f-2600-4591-a5ed-34cee5e53a49' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.849976, -24.75    , ...,  44.75    ,  44.850006,
        44.949997], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>71.95 71.85 71.75 ... 30.15 30.05</div><input id='attrs-2bbe65fe-763a-4b2d-80d6-3084d46da279' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2bbe65fe-763a-4b2d-80d6-3084d46da279' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6397dabe-d2fd-4eef-9d18-f71619e9b304' class='xr-var-data-in' type='checkbox'><label for='data-6397dabe-d2fd-4eef-9d18-f71619e9b304' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([71.95, 71.85, 71.75, ..., 30.25, 30.15, 30.05], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-34a8a3e1-7d15-47c8-9adc-eb72dd1261fd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-34a8a3e1-7d15-47c8-9adc-eb72dd1261fd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-82bdc54f-2238-452d-b56a-e9702bbabfec' class='xr-var-data-in' type='checkbox'><label for='data-82bdc54f-2238-452d-b56a-e9702bbabfec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([0.], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a41e3e8f-79ef-4e89-874b-a497832f8d0c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a41e3e8f-79ef-4e89-874b-a497832f8d0c' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.02787 0.02787 ... 4.235 3.931</div><input id='attrs-b62cbc73-170c-4cc9-a6ff-97d89224f5c6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b62cbc73-170c-4cc9-a6ff-97d89224f5c6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31d50b8c-f4e2-46b8-b318-056542be2db1' class='xr-var-data-in' type='checkbox'><label for='data-31d50b8c-f4e2-46b8-b318-056542be2db1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[0.02787461, 0.02787461, 0.02771118, ..., 0.15140247,
          0.14035352, 0.13047698],
         [0.02787461, 0.02787461, 0.02787461, ..., 0.17789151,
          0.17789151, 0.17789151],
         [0.02787461, 0.02787461, 0.02787461, ..., 0.17789151,
          0.17789151, 0.17789151],
         ...,
         [0.04484161, 0.04464976, 0.04462844, ..., 4.309593  ,
          4.309593  , 4.309593  ],
         [0.04396053, 0.04391233, 0.04391944, ..., 4.309593  ,
          4.309593  , 4.266726  ],
         [0.04391944, 0.04391944, 0.04391944, ..., 3.0567997 ,
          4.2351356 , 3.9313145 ]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>61.97 61.97 61.81 ... 124.9 125.3</div><input id='attrs-c7f3c50c-08e7-4e95-8458-ac572ef8b880' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c7f3c50c-08e7-4e95-8458-ac572ef8b880' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a4cddd9a-e7de-4fcf-b948-2f3b1d1bc11f' class='xr-var-data-in' type='checkbox'><label for='data-a4cddd9a-e7de-4fcf-b948-2f3b1d1bc11f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[ 61.965622,  61.965393,  61.80987 , ...,  50.012226,
           49.533863,  49.057087],
         [ 61.965622,  61.965622,  61.965622, ...,  51.123573,
           51.123573,  51.123573],
         [ 61.965622,  61.965622,  61.965622, ...,  51.123573,
           51.123573,  51.123573],
         ...,
         [ 58.006176,  57.504444,  56.047306, ..., 125.32788 ,
          125.32788 , 125.32788 ],
         [ 56.17458 ,  55.964684,  55.96062 , ..., 125.32788 ,
          125.32788 , 125.32767 ],
         [ 55.96062 ,  55.96062 ,  55.96062 , ..., 118.43542 ,
          124.91819 , 125.32606 ]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.7773 0.7773 ... 52.86 52.61</div><input id='attrs-0c20cf19-20db-48ec-80e0-f7ac17fbed76' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0c20cf19-20db-48ec-80e0-f7ac17fbed76' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-650887f2-17cf-4318-8717-747904678d82' class='xr-var-data-in' type='checkbox'><label for='data-650887f2-17cf-4318-8717-747904678d82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[ 0.77728105,  0.77728105,  0.79217404, ...,  2.511054  ,
           2.5265799 ,  2.546816  ],
         [ 0.77728105,  0.77728105,  0.77728105, ...,  2.4791365 ,
           2.4791365 ,  2.4791365 ],
         [ 0.77728105,  0.77728105,  0.77728105, ...,  2.4791365 ,
           2.4791365 ,  2.4791365 ],
         ...,
         [ 9.749049  ,  9.740864  ,  9.613364  , ..., 53.43701   ,
          53.43701   , 53.43701   ],
         [ 9.998307  , 10.912123  , 10.929857  , ..., 53.43701   ,
          53.43701   , 53.342907  ],
         [10.929857  , 10.929857  , 10.929857  , ..., 43.721504  ,
          52.85957   , 52.60667   ]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5984 0.5984 ... 30.56 30.76</div><input id='attrs-fdc5bf4d-9692-4e90-904a-67f82f70305f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fdc5bf4d-9692-4e90-904a-67f82f70305f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3f6af29b-ac5b-445d-ae92-e0d17e452da0' class='xr-var-data-in' type='checkbox'><label for='data-3f6af29b-ac5b-445d-ae92-e0d17e452da0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[ 0.5983948,  0.5983948,  0.6123783, ...,  1.8387041,
           1.8370837,  1.8356059],
         [ 0.5983948,  0.5983948,  0.5983948, ...,  1.8662741,
           1.8662741,  1.8662741],
         [ 0.5983948,  0.5983948,  0.5983948, ...,  1.8662741,
           1.8662741,  1.8662741],
         ...,
         [ 4.6096487,  4.6148496,  4.574519 , ..., 30.862682 ,
          30.862682 , 30.862682 ],
         [ 4.63375  ,  4.6709533,  4.671948 , ..., 30.862682 ,
          30.862682 , 30.849081 ],
         [ 4.671948 ,  4.671948 ,  4.671948 , ..., 25.94779  ,
          30.555159 , 30.761532 ]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001265 0.001265 ... 23.63 22.91</div><input id='attrs-900b3f72-babb-4c52-b569-a0ac9a97a788' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-900b3f72-babb-4c52-b569-a0ac9a97a788' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-890ebcee-fe99-4923-be50-eb897cff1ad2' class='xr-var-data-in' type='checkbox'><label for='data-890ebcee-fe99-4923-be50-eb897cff1ad2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[[1.2649833e-03, 1.2649833e-03, 8.8108622e-04, ...,
          3.6806125e-02, 3.7403006e-02, 3.8014073e-02],
         [1.2649833e-03, 1.2649833e-03, 1.2649833e-03, ...,
          4.0259570e-02, 4.0259570e-02, 4.0259570e-02],
         [1.2649833e-03, 1.2649833e-03, 1.2649833e-03, ...,
          4.0259570e-02, 4.0259570e-02, 4.0259570e-02],
         ...,
         [1.3102422e-02, 1.2903470e-02, 1.2022397e-02, ...,
          2.4014425e+01, 2.4014425e+01, 2.4014425e+01],
         [1.2306614e-02, 1.1993974e-02, 1.1993974e-02, ...,
          2.4014425e+01, 2.4014425e+01, 2.3863991e+01],
         [1.1993974e-02, 1.1993974e-02, 1.1993974e-02, ...,
          1.7468096e+01, 2.3625347e+01, 2.2913668e+01]]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-817de2be-813c-4251-9633-ec1482e97cfe' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-817de2be-813c-4251-9633-ec1482e97cfe' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Let us now also drop the dimensions <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">level</span></code>, which only have one record each. The xarray function <code class="docutils literal notranslate"><span class="pre">squeeze()</span></code> drops all dimensions with only one entry. The result is a dataset with two remaining dimensions: <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">longitude</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_daily</span> <span class="o">=</span> <span class="n">eaqi_daily</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">eaqi_daily</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 420, longitude: 700)
Coordinates:
  * longitude   (longitude) float32 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude    (latitude) float32 71.95 71.85 71.75 71.65 ... 30.25 30.15 30.05
Data variables:
    no2_conc    (latitude, longitude) float32 0.02787 0.02787 ... 4.235 3.931
    o3_conc     (latitude, longitude) float32 61.97 61.97 61.81 ... 124.9 125.3
    pm10_conc   (latitude, longitude) float32 0.7773 0.7773 ... 52.86 52.61
    pm2p5_conc  (latitude, longitude) float32 0.5984 0.5984 ... 30.56 30.76
    so2_conc    (latitude, longitude) float32 0.001265 0.001265 ... 23.63 22.91</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-234f96cb-549e-49e5-9a87-d52db4a2b131' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-234f96cb-549e-49e5-9a87-d52db4a2b131' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 420</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ac99c71a-826d-48b7-bcbe-e41b7d581285' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ac99c71a-826d-48b7-bcbe-e41b7d581285' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-65494fde-3333-4bb5-b399-ed06e45f6059' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-65494fde-3333-4bb5-b399-ed06e45f6059' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62ef5ebf-fbf8-4554-9f80-6d5e3ab114ec' class='xr-var-data-in' type='checkbox'><label for='data-62ef5ebf-fbf8-4554-9f80-6d5e3ab114ec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.849976, -24.75    , ...,  44.75    ,  44.850006,
        44.949997], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>71.95 71.85 71.75 ... 30.15 30.05</div><input id='attrs-e8a2d71c-0816-4718-b55c-7485103468e1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e8a2d71c-0816-4718-b55c-7485103468e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ffacbbe-4bc1-448f-b2c2-8773c0eaeef9' class='xr-var-data-in' type='checkbox'><label for='data-2ffacbbe-4bc1-448f-b2c2-8773c0eaeef9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([71.95, 71.85, 71.75, ..., 30.25, 30.15, 30.05], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-108be4b6-c87e-43b1-b705-293fbff2e388' class='xr-section-summary-in' type='checkbox'  checked><label for='section-108be4b6-c87e-43b1-b705-293fbff2e388' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.02787 0.02787 ... 4.235 3.931</div><input id='attrs-a01c1b2d-e2b6-40a5-aeee-73cc627277b8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a01c1b2d-e2b6-40a5-aeee-73cc627277b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60e36483-8231-4c03-922e-9e76d6e9bfe9' class='xr-var-data-in' type='checkbox'><label for='data-60e36483-8231-4c03-922e-9e76d6e9bfe9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0.02787461, 0.02787461, 0.02771118, ..., 0.15140247, 0.14035352,
        0.13047698],
       [0.02787461, 0.02787461, 0.02787461, ..., 0.17789151, 0.17789151,
        0.17789151],
       [0.02787461, 0.02787461, 0.02787461, ..., 0.17789151, 0.17789151,
        0.17789151],
       ...,
       [0.04484161, 0.04464976, 0.04462844, ..., 4.309593  , 4.309593  ,
        4.309593  ],
       [0.04396053, 0.04391233, 0.04391944, ..., 4.309593  , 4.309593  ,
        4.266726  ],
       [0.04391944, 0.04391944, 0.04391944, ..., 3.0567997 , 4.2351356 ,
        3.9313145 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>61.97 61.97 61.81 ... 124.9 125.3</div><input id='attrs-40c55849-c78d-4127-896a-53ddffab1713' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-40c55849-c78d-4127-896a-53ddffab1713' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88946eb8-7a1d-4ded-a78d-f1123b49fcb4' class='xr-var-data-in' type='checkbox'><label for='data-88946eb8-7a1d-4ded-a78d-f1123b49fcb4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 61.965622,  61.965393,  61.80987 , ...,  50.012226,  49.533863,
         49.057087],
       [ 61.965622,  61.965622,  61.965622, ...,  51.123573,  51.123573,
         51.123573],
       [ 61.965622,  61.965622,  61.965622, ...,  51.123573,  51.123573,
         51.123573],
       ...,
       [ 58.006176,  57.504444,  56.047306, ..., 125.32788 , 125.32788 ,
        125.32788 ],
       [ 56.17458 ,  55.964684,  55.96062 , ..., 125.32788 , 125.32788 ,
        125.32767 ],
       [ 55.96062 ,  55.96062 ,  55.96062 , ..., 118.43542 , 124.91819 ,
        125.32606 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.7773 0.7773 ... 52.86 52.61</div><input id='attrs-fe012ff7-6917-4b89-97fa-98701a8c1beb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fe012ff7-6917-4b89-97fa-98701a8c1beb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d1fc5f5-df8e-41e1-bc31-1fe171cfa75f' class='xr-var-data-in' type='checkbox'><label for='data-5d1fc5f5-df8e-41e1-bc31-1fe171cfa75f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 0.77728105,  0.77728105,  0.79217404, ...,  2.511054  ,
         2.5265799 ,  2.546816  ],
       [ 0.77728105,  0.77728105,  0.77728105, ...,  2.4791365 ,
         2.4791365 ,  2.4791365 ],
       [ 0.77728105,  0.77728105,  0.77728105, ...,  2.4791365 ,
         2.4791365 ,  2.4791365 ],
       ...,
       [ 9.749049  ,  9.740864  ,  9.613364  , ..., 53.43701   ,
        53.43701   , 53.43701   ],
       [ 9.998307  , 10.912123  , 10.929857  , ..., 53.43701   ,
        53.43701   , 53.342907  ],
       [10.929857  , 10.929857  , 10.929857  , ..., 43.721504  ,
        52.85957   , 52.60667   ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5984 0.5984 ... 30.56 30.76</div><input id='attrs-5f86246d-d270-458a-80f5-955b26253d06' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5f86246d-d270-458a-80f5-955b26253d06' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4aba1183-80da-4851-8ae3-c7ec171fd492' class='xr-var-data-in' type='checkbox'><label for='data-4aba1183-80da-4851-8ae3-c7ec171fd492' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 0.5983948,  0.5983948,  0.6123783, ...,  1.8387041,  1.8370837,
         1.8356059],
       [ 0.5983948,  0.5983948,  0.5983948, ...,  1.8662741,  1.8662741,
         1.8662741],
       [ 0.5983948,  0.5983948,  0.5983948, ...,  1.8662741,  1.8662741,
         1.8662741],
       ...,
       [ 4.6096487,  4.6148496,  4.574519 , ..., 30.862682 , 30.862682 ,
        30.862682 ],
       [ 4.63375  ,  4.6709533,  4.671948 , ..., 30.862682 , 30.862682 ,
        30.849081 ],
       [ 4.671948 ,  4.671948 ,  4.671948 , ..., 25.94779  , 30.555159 ,
        30.761532 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001265 0.001265 ... 23.63 22.91</div><input id='attrs-c0c4103c-9553-4d8e-a1fc-d826b2c4f692' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c0c4103c-9553-4d8e-a1fc-d826b2c4f692' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ebc2f2c7-d7e7-48c7-84a4-5648f8f7f283' class='xr-var-data-in' type='checkbox'><label for='data-ebc2f2c7-d7e7-48c7-84a4-5648f8f7f283' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.2649833e-03, 1.2649833e-03, 8.8108622e-04, ..., 3.6806125e-02,
        3.7403006e-02, 3.8014073e-02],
       [1.2649833e-03, 1.2649833e-03, 1.2649833e-03, ..., 4.0259570e-02,
        4.0259570e-02, 4.0259570e-02],
       [1.2649833e-03, 1.2649833e-03, 1.2649833e-03, ..., 4.0259570e-02,
        4.0259570e-02, 4.0259570e-02],
       ...,
       [1.3102422e-02, 1.2903470e-02, 1.2022397e-02, ..., 2.4014425e+01,
        2.4014425e+01, 2.4014425e+01],
       [1.2306614e-02, 1.1993974e-02, 1.1993974e-02, ..., 2.4014425e+01,
        2.4014425e+01, 2.3863991e+01],
       [1.1993974e-02, 1.1993974e-02, 1.1993974e-02, ..., 1.7468096e+01,
        2.3625347e+01, 2.2913668e+01]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2bb88d33-9d3e-4724-bea2-1adf85508a35' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2bb88d33-9d3e-4724-bea2-1adf85508a35' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="classify-daily-maximum-concentration-values-into-european-air-quality-index-levels">
<h3>1.3 Classify daily maximum concentration values into European Air Quality Index levels<a class="headerlink" href="#classify-daily-maximum-concentration-values-into-european-air-quality-index-levels" title="Permalink to this headline">¶</a></h3>
<p>Now, we can classify the daily maximum concentration values into European Air Quality index levels. For this, we first define for each key pollutant the thresholds and save these as a list of threshold limits. In a next step, we combine the threshold lists into a list of lists, which we call <code class="docutils literal notranslate"><span class="pre">bin_list</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">no2_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">ozone_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">380</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span>
<span class="n">pm10_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span>
<span class="n">pm25_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">1200</span><span class="p">]</span>
<span class="n">so2_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1250</span><span class="p">]</span>

<span class="n">bin_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">no2_limits</span><span class="p">,</span> <span class="n">ozone_limits</span><span class="p">,</span> <span class="n">pm10_limits</span><span class="p">,</span> <span class="n">pm25_limits</span><span class="p">,</span> <span class="n">so2_limits</span><span class="p">]</span>
<span class="n">bin_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0, 40, 90, 120, 230, 340, 1000],
 [0, 50, 100, 130, 240, 380, 800],
 [0, 10, 20, 25, 50, 75, 800],
 [0, 20, 40, 50, 100, 150, 1200],
 [0, 100, 200, 350, 500, 750, 1250]]
</pre></div>
</div>
</div>
</div>
<br><p>The next step is then to store all variables available in the xarray.Dataset <code class="docutils literal notranslate"><span class="pre">eaqi_daily</span></code> in a list with the name <code class="docutils literal notranslate"><span class="pre">variable_list</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">eaqi_daily</span><span class="o">.</span><span class="n">variables</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>
<span class="n">variable_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;no2_conc&#39;, &#39;o3_conc&#39;, &#39;pm10_conc&#39;, &#39;pm2p5_conc&#39;, &#39;so2_conc&#39;]
</pre></div>
</div>
</div>
</div>
<br><p>Now, we can loop over all data variables in the dataset and apply a customized function with the <code class="docutils literal notranslate"><span class="pre">apply_ufunc()</span></code> functionality of xarray:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">function()</span></code>: apply the numpy function <code class="docutils literal notranslate"><span class="pre">digitize()</span></code>, which returns the indices of the bins (thresholds) to which each value in the input array belongs to</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input</span> <span class="pre">array</span></code>: provide input data array, whose values shall be classified</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">thresholds</span> <span class="pre">(bin)</span></code>: provide list of thresholds, groups of bins</p></li>
</ul>
<p>At the end, we create a list of all classified data arrays, which has the name <code class="docutils literal notranslate"><span class="pre">classified_arrays</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">classified_arrays</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">eaqi_daily</span><span class="p">)):</span>
    <span class="n">variable</span> <span class="o">=</span> <span class="n">variable_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">,</span>
              <span class="n">eaqi_daily</span><span class="p">[</span><span class="n">variable</span><span class="p">],</span>
              <span class="n">bin_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">classified_arrays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<br><p>The function <code class="docutils literal notranslate"><span class="pre">merge()</span></code> allows us to merge the list of xarray.DataArray items into a xarray.Dataset. The resulting dataset has again five variables, but each grid point of the variable’s array is now classified according to the European Air Quality Index levels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">classified_arrays</span><span class="p">)</span>
<span class="n">combined</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 420, longitude: 700)
Coordinates:
  * longitude   (longitude) float32 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude    (latitude) float32 71.95 71.85 71.75 71.65 ... 30.25 30.15 30.05
Data variables:
    no2_conc    (latitude, longitude) int64 1 1 1 1 1 1 1 1 ... 1 1 1 1 1 1 1 1
    o3_conc     (latitude, longitude) int64 2 2 2 2 2 2 2 2 ... 3 3 3 3 3 3 3 3
    pm10_conc   (latitude, longitude) int64 1 1 1 1 1 1 1 1 ... 4 4 4 4 4 4 5 5
    pm2p5_conc  (latitude, longitude) int64 1 1 1 1 1 1 1 1 ... 2 2 2 2 2 2 2 2
    so2_conc    (latitude, longitude) int64 1 1 1 1 1 1 1 1 ... 1 1 1 1 1 1 1 1</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1c401150-846f-466a-a094-64c71eb9b583' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1c401150-846f-466a-a094-64c71eb9b583' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 420</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-658eef4a-9cd2-4d11-bb2e-bf1c6d0e82a2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-658eef4a-9cd2-4d11-bb2e-bf1c6d0e82a2' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-f3b83e1d-cbe7-4a51-b37e-fe31aa43d03e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f3b83e1d-cbe7-4a51-b37e-fe31aa43d03e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-997f0c59-187a-4c8d-81b0-2f454f83c4fa' class='xr-var-data-in' type='checkbox'><label for='data-997f0c59-187a-4c8d-81b0-2f454f83c4fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.849976, -24.75    , ...,  44.75    ,  44.850006,
        44.949997], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>71.95 71.85 71.75 ... 30.15 30.05</div><input id='attrs-ce2ff666-6493-4493-9fa9-3db74dd8a5a8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ce2ff666-6493-4493-9fa9-3db74dd8a5a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c447a21e-ca82-404f-8c04-7d01cb92e34c' class='xr-var-data-in' type='checkbox'><label for='data-c447a21e-ca82-404f-8c04-7d01cb92e34c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([71.95, 71.85, 71.75, ..., 30.25, 30.15, 30.05], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-490af2f5-d404-4bc0-a112-44b6fc2f550d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-490af2f5-d404-4bc0-a112-44b6fc2f550d' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1 1 1 ... 1 1 1 1 1 1 1 1</div><input id='attrs-cdc6ef38-3f6e-4b4b-b826-155a0905d80b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cdc6ef38-3f6e-4b4b-b826-155a0905d80b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7035c6a0-f9bd-45b3-980c-e9b88b0ed1e7' class='xr-var-data-in' type='checkbox'><label for='data-7035c6a0-f9bd-45b3-980c-e9b88b0ed1e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       ...,
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 2 2 2 2 2 2 2 ... 3 3 3 3 3 3 3 3</div><input id='attrs-aa312fa3-6865-4646-a8d7-67a782b65028' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aa312fa3-6865-4646-a8d7-67a782b65028' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e313caeb-6e22-41b3-8e17-fab150ca9450' class='xr-var-data-in' type='checkbox'><label for='data-e313caeb-6e22-41b3-8e17-fab150ca9450' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[2, 2, 2, ..., 2, 1, 1],
       [2, 2, 2, ..., 2, 2, 2],
       [2, 2, 2, ..., 2, 2, 2],
       ...,
       [2, 2, 2, ..., 3, 3, 3],
       [2, 2, 2, ..., 3, 3, 3],
       [2, 2, 2, ..., 3, 3, 3]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1 1 1 ... 4 4 4 4 4 4 5 5</div><input id='attrs-c20066ca-b386-478b-9152-0545c42e9303' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c20066ca-b386-478b-9152-0545c42e9303' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2acfc321-9cc8-4a33-9f36-0f55f7f3ab38' class='xr-var-data-in' type='checkbox'><label for='data-2acfc321-9cc8-4a33-9f36-0f55f7f3ab38' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       ...,
       [1, 1, 1, ..., 5, 5, 5],
       [1, 2, 2, ..., 5, 5, 5],
       [2, 2, 2, ..., 4, 5, 5]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1 1 1 ... 2 2 2 2 2 2 2 2</div><input id='attrs-ea9556d7-98fa-4219-bcdc-3ad073918306' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ea9556d7-98fa-4219-bcdc-3ad073918306' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8cf063b3-60b1-4afb-ad19-f0d30c0947c1' class='xr-var-data-in' type='checkbox'><label for='data-8cf063b3-60b1-4afb-ad19-f0d30c0947c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       ...,
       [1, 1, 1, ..., 2, 2, 2],
       [1, 1, 1, ..., 2, 2, 2],
       [1, 1, 1, ..., 2, 2, 2]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(latitude, longitude)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1 1 1 ... 1 1 1 1 1 1 1 1</div><input id='attrs-64189d85-66e2-42bb-8a63-c3aacc9acd1a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-64189d85-66e2-42bb-8a63-c3aacc9acd1a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5fb37c99-3dc1-48f8-8662-89aff4479484' class='xr-var-data-in' type='checkbox'><label for='data-5fb37c99-3dc1-48f8-8662-89aff4479484' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       ...,
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1],
       [1, 1, 1, ..., 1, 1, 1]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ca9fbe30-dc54-411e-8171-38074383425a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ca9fbe30-dc54-411e-8171-38074383425a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<br><p>The last step before we can visualize the Air Quality Index in Europe for 15 July 2021 is to create the overall daily European Air Quality index based on the maximum index level among the five key pollutants of the respective day. For this, we can tranform the xarray.Dataset above into a xarray.DataArray with the function <code class="docutils literal notranslate"><span class="pre">to_array()</span></code>. The result is a three-dimensional data array and the five data variables will be added as an additional dimension with the name <code class="docutils literal notranslate"><span class="pre">variable</span></code>. From this data array, we can retrieve for each grid point the maximum value across all variables with the function <code class="docutils literal notranslate"><span class="pre">max()</span></code>.</p>
<p>The result is a two-dimensional data array, which holds for each grid point the overall Air Quality Index level.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_index</span> <span class="o">=</span> <span class="n">combined</span><span class="o">.</span><span class="n">to_array</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;variable&#39;</span><span class="p">)</span>
<span class="n">final_index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (latitude: 420, longitude: 700)&gt;
array([[2, 2, 2, ..., 2, 1, 1],
       [2, 2, 2, ..., 2, 2, 2],
       [2, 2, 2, ..., 2, 2, 2],
       ...,
       [2, 2, 2, ..., 5, 5, 5],
       [2, 2, 2, ..., 5, 5, 5],
       [2, 2, 2, ..., 4, 5, 5]])
Coordinates:
  * longitude  (longitude) float32 -24.95 -24.85 -24.75 ... 44.75 44.85 44.95
  * latitude   (latitude) float32 71.95 71.85 71.75 71.65 ... 30.25 30.15 30.05</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 420</li><li><span class='xr-has-index'>longitude</span>: 700</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-ef0722c5-f3c5-44e4-b16c-a57d37572b46' class='xr-array-in' type='checkbox' checked><label for='section-ef0722c5-f3c5-44e4-b16c-a57d37572b46' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 ... 4 4 4 4 4 4 4 4 4 4 4 4 4 4 5 5</span></div><div class='xr-array-data'><pre>array([[2, 2, 2, ..., 2, 1, 1],
       [2, 2, 2, ..., 2, 2, 2],
       [2, 2, 2, ..., 2, 2, 2],
       ...,
       [2, 2, 2, ..., 5, 5, 5],
       [2, 2, 2, ..., 5, 5, 5],
       [2, 2, 2, ..., 4, 5, 5]])</pre></div></div></li><li class='xr-section-item'><input id='section-dfafc10e-7bbc-40b1-b2ac-021aec93ef17' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dfafc10e-7bbc-40b1-b2ac-021aec93ef17' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-24.95 -24.85 ... 44.85 44.95</div><input id='attrs-1b03f39a-0616-464d-8d99-4d861d33e85d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1b03f39a-0616-464d-8d99-4d861d33e85d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-41beec96-0c8f-4100-b187-20c597f67a57' class='xr-var-data-in' type='checkbox'><label for='data-41beec96-0c8f-4100-b187-20c597f67a57' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-24.950012, -24.849976, -24.75    , ...,  44.75    ,  44.850006,
        44.949997], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>71.95 71.85 71.75 ... 30.15 30.05</div><input id='attrs-2e617c0d-f20f-4fab-93ac-e5e6e14b6712' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e617c0d-f20f-4fab-93ac-e5e6e14b6712' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf7391b8-7070-4aa5-97ee-d5961ba3d2ad' class='xr-var-data-in' type='checkbox'><label for='data-cf7391b8-7070-4aa5-97ee-d5961ba3d2ad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([71.95, 71.85, 71.75, ..., 30.25, 30.15, 30.05], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b6c7abcd-88d9-47aa-a451-50fd81548cd9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b6c7abcd-88d9-47aa-a451-50fd81548cd9' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<br></div>
<div class="section" id="visualize-a-map-of-air-quality-index-levels-in-europe-for-15-july-2021">
<h3>1.4 Visualize a map of Air Quality Index levels in Europe for 15 July 2021<a class="headerlink" href="#visualize-a-map-of-air-quality-index-levels-in-europe-for-15-july-2021" title="Permalink to this headline">¶</a></h3>
<p>The last step is now to visualize the overall daily Air Quality Index levels in Europe for 15 July 2021. The visualisation function consists of five main parts:</p>
<ul class="simple">
<li><p><strong>1. Initiate the matplotlib figure</strong>: Initiate a figure and axes objects and add a colorbar</p></li>
<li><p><strong>2. Plotting function</strong>: Plot the xarray.DataArray with the pcolormesh() function from matplotlib and provide the customized colormap as color range</p></li>
<li><p><strong>3. Set title of the map</strong>: Set a title to the resulting map</p></li>
<li><p><strong>4. Customize colorbar entries:</strong> Customize the labels of the colorbar and indicate the index levels from ‘very good’ to ‘extremely poor’</p></li>
<li><p><strong>5. Add additional features to the map:</strong> Add additional features such as coastlines and a geographic grid</p></li>
</ul>
<p><strong>Note:</strong> before plotting, we additionally define a customized colormap based on the official EAQI index colors. We also add additionally the labels to the six EAQI index levels, which range from ‘Very good’ to ‘Extremely poor’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;#5AAA5F&#39;</span><span class="p">,</span> <span class="s1">&#39;#A7D25C&#39;</span><span class="p">,</span> <span class="s1">&#39;#ECD347&#39;</span><span class="p">,</span> <span class="s1">&#39;#F5BE41&#39;</span><span class="p">,</span> <span class="s1">&#39;#F09235&#39;</span><span class="p">,</span> <span class="s1">&#39;#D93322&#39;</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Very good&#39;</span><span class="p">,</span> <span class="s1">&#39;Good&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Poor&#39;</span><span class="p">,</span> <span class="s1">&#39;Very Poor&#39;</span><span class="p">,</span> <span class="s1">&#39;Extremely Poor&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiate a matplotlib figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># Plotting function</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">final_index</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> 
                     <span class="n">final_index</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> 
                     <span class="n">final_index</span><span class="p">,</span> 
                     <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span>
                     <span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">)</span>

<span class="c1"># Set the title of the plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;European Air Quality Index levels - 15 July 2021&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">20.0</span><span class="p">)</span>

<span class="c1"># Customize colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">fraction</span><span class="o">=</span><span class="mf">0.028</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">6.5</span><span class="p">])</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

<span class="c1"># Add additional features such as coastlines and a geographic grid</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">12</span><span class="p">}</span>
<span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">12</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;European Air Quality Index levels - 15 July 2021&#39;)
</pre></div>
</div>
<img alt="_images/07_European_Air_Quality_Index_Calculation_66_1.png" src="_images/07_European_Air_Quality_Index_Calculation_66_1.png" />
</div>
</div>
<br></div>
</div>
<div class="section" id="calculate-the-daily-european-air-quality-index-for-london-in-december-2020">
<h2>2. Calculate the daily European Air Quality Index for London in December 2020<a class="headerlink" href="#calculate-the-daily-european-air-quality-index-for-london-in-december-2020" title="Permalink to this headline">¶</a></h2>
<p>Next, we want to calculate the daily European Air Quality Index for London, UK in December 2020.</p>
<div class="section" id="id1">
<h3>2.1 Request data from the ADS programmatically with the CDS API<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Let us request data from the Atmosphere Data Store programmatically with the help of the CDS API. We again set manually the CDS API credentials. First, you have to define two variables: <code class="docutils literal notranslate"><span class="pre">URL</span></code> and <code class="docutils literal notranslate"><span class="pre">KEY</span></code> which build together your CDS API key. Below, you have to replace the <code class="docutils literal notranslate"><span class="pre">#########</span></code> with your personal ADS key. Please find <a class="reference external" href="https://ads.atmosphere.copernicus.eu/api-how-to">here</a> your personal ADS key.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://ads.atmosphere.copernicus.eu/api/v2&#39;</span>
<span class="n">KEY</span> <span class="o">=</span> <span class="s1">&#39;######################################&#39;</span>
</pre></div>
</div>
</div>
</div>
<br><p>The next step is then to request the data with the help of the CDS API. Below, we request analysis data from the <code class="docutils literal notranslate"><span class="pre">CAMS</span> <span class="pre">European</span> <span class="pre">air</span> <span class="pre">quality</span> <span class="pre">forecasts</span></code> dataset. We request hourly data for December 2020 for the five main pollutants for which the European Air Quality Index is calculated: <code class="docutils literal notranslate"><span class="pre">nitrogen_dioxide</span></code>, <code class="docutils literal notranslate"><span class="pre">ozone</span></code>, <code class="docutils literal notranslate"><span class="pre">particulate_matter_10um</span></code>, <code class="docutils literal notranslate"><span class="pre">particulate_matter_2.5um</span></code> and <code class="docutils literal notranslate"><span class="pre">sulphur_dioxide</span></code>. In the data request below, we additionally set the <code class="docutils literal notranslate"><span class="pre">area</span></code> key, as we want to tailor the data request to only a small geographical area around London, United Kingdom.</p>
<p>Let us store the dataset under the name <code class="docutils literal notranslate"><span class="pre">202012_eaqi_london.nc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;cams-europe-air-quality-forecasts&#39;</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="s1">&#39;euradim&#39;</span><span class="p">,</span>
        <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;2020-12-01/2020-12-31&#39;</span><span class="p">,</span>
        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;netcdf&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;analysis&#39;</span><span class="p">,</span>
        <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;01:00&#39;</span><span class="p">,</span> <span class="s1">&#39;02:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;03:00&#39;</span><span class="p">,</span> <span class="s1">&#39;04:00&#39;</span><span class="p">,</span> <span class="s1">&#39;05:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;06:00&#39;</span><span class="p">,</span> <span class="s1">&#39;07:00&#39;</span><span class="p">,</span> <span class="s1">&#39;08:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;09:00&#39;</span><span class="p">,</span> <span class="s1">&#39;10:00&#39;</span><span class="p">,</span> <span class="s1">&#39;11:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;12:00&#39;</span><span class="p">,</span> <span class="s1">&#39;13:00&#39;</span><span class="p">,</span> <span class="s1">&#39;14:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;15:00&#39;</span><span class="p">,</span> <span class="s1">&#39;16:00&#39;</span><span class="p">,</span> <span class="s1">&#39;17:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;18:00&#39;</span><span class="p">,</span> <span class="s1">&#39;19:00&#39;</span><span class="p">,</span> <span class="s1">&#39;20:00&#39;</span><span class="p">,</span>
            <span class="s1">&#39;21:00&#39;</span><span class="p">,</span> <span class="s1">&#39;22:00&#39;</span><span class="p">,</span> <span class="s1">&#39;23:00&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;leadtime_hour&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
        <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s1">&#39;nitrogen_dioxide&#39;</span><span class="p">,</span> <span class="s1">&#39;ozone&#39;</span><span class="p">,</span> <span class="s1">&#39;particulate_matter_10um&#39;</span><span class="p">,</span>
            <span class="s1">&#39;particulate_matter_2.5um&#39;</span><span class="p">,</span> <span class="s1">&#39;sulphur_dioxide&#39;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">51.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s1">&#39;./202012_eaqi_london.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<br></div>
<div class="section" id="id2">
<h3>2.2 Load and prepare the European air quality forecast data<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>The European air quality forecasts data are available either in <code class="docutils literal notranslate"><span class="pre">GRIB</span></code> or in <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code> format. Above, we requested the data in the <code class="docutils literal notranslate"><span class="pre">NetCDF</span></code> format. You can use the Python library <a class="reference external" href="http://xarray.pydata.org/en/stable/">xarray</a> and the function <code class="docutils literal notranslate"><span class="pre">open_dataset()</span></code> to load a NetCDF file as <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>. A xarray Dataset is a collection of one or more variables that share the same dimensions. Below, you see that the Dataset has four dimensions, <code class="docutils literal notranslate"><span class="pre">latitude</span></code>, <code class="docutils literal notranslate"><span class="pre">level</span></code>, <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>, and five variables, <code class="docutils literal notranslate"><span class="pre">no2_conc</span></code>, <code class="docutils literal notranslate"><span class="pre">o3_conc</span></code>, <code class="docutils literal notranslate"><span class="pre">pm10_conc</span></code>, <code class="docutils literal notranslate"><span class="pre">pm2p5_conc</span></code> and <code class="docutils literal notranslate"><span class="pre">so2_conc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_london</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;./202012_eaqi_london.nc&#39;</span><span class="p">)</span>
<span class="n">eaqi_london</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 3, level: 1, longitude: 3, time: 744)
Coordinates:
  * longitude   (longitude) float32 359.8 359.9 360.0
  * latitude    (latitude) float32 51.55 51.45 51.35
  * level       (level) float32 0.0
  * time        (time) timedelta64[ns] 00:00:00 01:00:00 ... 30 days 23:00:00
Data variables:
    no2_conc    (time, level, latitude, longitude) float32 15.51 10.58 ... 46.72
    o3_conc     (time, level, latitude, longitude) float32 37.22 36.29 ... 1.924
    pm10_conc   (time, level, latitude, longitude) float32 9.667 10.13 ... 19.78
    pm2p5_conc  (time, level, latitude, longitude) float32 8.624 9.112 ... 18.0
    so2_conc    (time, level, latitude, longitude) float32 2.99 3.44 ... 11.16
Attributes:
    title:        NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface
    institution:  Data produced by RIUUK
    source:       Data from EURAD-IM model
    history:      Model EURAD ANALYSIS
    ANALYSIS:     Europe, 20201201-20201231+[0H_23H]
    summary:      EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concent...
    project:      MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2b28f7a9-d9a4-452b-8f9f-76c02884ed1c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2b28f7a9-d9a4-452b-8f9f-76c02884ed1c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 3</li><li><span class='xr-has-index'>level</span>: 1</li><li><span class='xr-has-index'>longitude</span>: 3</li><li><span class='xr-has-index'>time</span>: 744</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8f4c5444-a055-4ae5-814b-4a4fb70c527c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8f4c5444-a055-4ae5-814b-4a4fb70c527c' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>359.8 359.9 360.0</div><input id='attrs-f74d3a60-9dee-4ab7-b3f6-45924ba0035a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f74d3a60-9dee-4ab7-b3f6-45924ba0035a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d0f948d-d352-4427-accc-17ab5940b094' class='xr-var-data-in' type='checkbox'><label for='data-0d0f948d-d352-4427-accc-17ab5940b094' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([359.75, 359.85, 359.95], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>51.55 51.45 51.35</div><input id='attrs-93a07605-5752-4d95-b513-ae050fad4084' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-93a07605-5752-4d95-b513-ae050fad4084' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cbe4b4f3-3abd-4b80-badf-c70b8ec17ede' class='xr-var-data-in' type='checkbox'><label for='data-cbe4b4f3-3abd-4b80-badf-c70b8ec17ede' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([51.55, 51.45, 51.35], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-ae2e541b-964a-4a75-a1e3-1459053117e9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ae2e541b-964a-4a75-a1e3-1459053117e9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b1556de1-4420-4f72-a9ac-2616745ddbef' class='xr-var-data-in' type='checkbox'><label for='data-b1556de1-4420-4f72-a9ac-2616745ddbef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>timedelta64[ns]</div><div class='xr-var-preview xr-preview'>00:00:00 ... 30 days 23:00:00</div><input id='attrs-c0aa6609-7a71-4102-b153-6311b1ad4082' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c0aa6609-7a71-4102-b153-6311b1ad4082' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-435243c4-80b8-41c8-9e49-65c675d0f470' class='xr-var-data-in' type='checkbox'><label for='data-435243c4-80b8-41c8-9e49-65c675d0f470' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ANALYSIS time from 20201201</dd></dl></div><div class='xr-var-data'><pre>array([               0,    3600000000000,    7200000000000, ...,
       2667600000000000, 2671200000000000, 2674800000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2f37febe-991d-4942-8774-9fd647ad3641' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2f37febe-991d-4942-8774-9fd647ad3641' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f067c2b6-f1d0-4804-95d5-e9861983e57f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f067c2b6-f1d0-4804-95d5-e9861983e57f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8afe6a30-7821-4190-b048-337e79f5ec32' class='xr-var-data-in' type='checkbox'><label for='data-8afe6a30-7821-4190-b048-337e79f5ec32' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Nitrogen Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_nitrogen_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[15.510345, ..., 18.174795],
         ...,
         [22.29408 , ..., 20.352665]]],


       ...,


       [[[36.479404, ..., 35.76146 ],
         ...,
         [55.333344, ..., 46.718143]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-749d91ae-8231-4a63-95b1-d67bab434730' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-749d91ae-8231-4a63-95b1-d67bab434730' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae2b9838-6335-4b60-a33e-8f8fd6a4e39c' class='xr-var-data-in' type='checkbox'><label for='data-ae2b9838-6335-4b60-a33e-8f8fd6a4e39c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Ozone</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_ozone_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[37.22002 , ..., 37.39592 ],
         ...,
         [32.99458 , ..., 32.783318]]],


       ...,


       [[[17.871344, ..., 16.65876 ],
         ...,
         [ 2.548177, ...,  1.923809]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ee03313b-107c-475d-8a47-0d373f449ac8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ee03313b-107c-475d-8a47-0d373f449ac8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4b9c3b10-a450-4dcf-93fe-f1d073fb8f8d' class='xr-var-data-in' type='checkbox'><label for='data-4b9c3b10-a450-4dcf-93fe-f1d073fb8f8d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM10 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 9.666528, ..., 10.224049],
         ...,
         [ 9.492814, ..., 10.637783]]],


       ...,


       [[[20.009241, ..., 21.280088],
         ...,
         [18.24215 , ..., 19.779423]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6bd586d4-7376-45f2-beab-cd55a1e97014' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6bd586d4-7376-45f2-beab-cd55a1e97014' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aa41be89-7196-4042-8c50-6e93ef785c1b' class='xr-var-data-in' type='checkbox'><label for='data-aa41be89-7196-4042-8c50-6e93ef785c1b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM2.5 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 8.624495, ...,  9.175108],
         ...,
         [ 8.614178, ...,  9.701087]]],


       ...,


       [[[16.95187 , ..., 18.536068],
         ...,
         [16.331594, ..., 17.998186]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2a46aa7e-76cd-499c-9159-0969f550bcc9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2a46aa7e-76cd-499c-9159-0969f550bcc9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5a4a8446-1bde-478e-8bfe-fe8bcbff780e' class='xr-var-data-in' type='checkbox'><label for='data-5a4a8446-1bde-478e-8bfe-fe8bcbff780e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Sulphur Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_sulfur_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 2.990305, ...,  3.666514],
         ...,
         [ 3.343928, ...,  4.098411]]],


       ...,


       [[[ 7.277549, ...,  8.871666],
         ...,
         [ 8.752181, ..., 11.158818]]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a52246fa-7fd0-4704-a702-9ea4a84375d3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a52246fa-7fd0-4704-a702-9ea4a84375d3' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface</dd><dt><span>institution :</span></dt><dd>Data produced by RIUUK</dd><dt><span>source :</span></dt><dd>Data from EURAD-IM model</dd><dt><span>history :</span></dt><dd>Model EURAD ANALYSIS</dd><dt><span>ANALYSIS :</span></dt><dd>Europe, 20201201-20201231+[0H_23H]</dd><dt><span>summary :</span></dt><dd>EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concentration at the Surface from 20201201-20201231+[0H_23H] on Europe</dd><dt><span>project :</span></dt><dd>MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</dd></dl></div></li></ul></div></div></div></div>
</div>
<br><p>Let us inspect the coordinates of the dataset more in detail. You see above that the dataset consists of 744 time steps and that the longitude values are on a [0, 360] grid.</p>
<p>However, if you inspect the time dimension more in detail, you see that the time is given in nanoseconds [ns]. As a next step, let us convert the time information into a human-readable time format and bring the longitude coordinates to a [-180, 180] grid.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_london</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;time&#x27; (time: 744)&gt;
array([               0,    3600000000000,    7200000000000, ...,
       2667600000000000, 2671200000000000, 2674800000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)
Coordinates:
  * time     (time) timedelta64[ns] 00:00:00 01:00:00 ... 30 days 23:00:00
Attributes:
    long_name:  ANALYSIS time from 20201201</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'time'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 744</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-4e4f25f1-cf42-4f27-914d-3c4f5a3ca16a' class='xr-array-in' type='checkbox' checked><label for='section-4e4f25f1-cf42-4f27-914d-3c4f5a3ca16a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>00:00:00 01:00:00 02:00:00 ... 30 days 22:00:00 30 days 23:00:00</span></div><div class='xr-array-data'><pre>array([               0,    3600000000000,    7200000000000, ...,
       2667600000000000, 2671200000000000, 2674800000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)</pre></div></div></li><li class='xr-section-item'><input id='section-845496b2-99a7-4a2e-accf-8891c5d72397' class='xr-section-summary-in' type='checkbox'  checked><label for='section-845496b2-99a7-4a2e-accf-8891c5d72397' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>timedelta64[ns]</div><div class='xr-var-preview xr-preview'>00:00:00 ... 30 days 23:00:00</div><input id='attrs-231eacad-3b29-4025-9a5b-53fd5cb1172f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-231eacad-3b29-4025-9a5b-53fd5cb1172f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5b8a7da6-efe5-4b11-aba5-2edf3b1dfeda' class='xr-var-data-in' type='checkbox'><label for='data-5b8a7da6-efe5-4b11-aba5-2edf3b1dfeda' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ANALYSIS time from 20201201</dd></dl></div><div class='xr-var-data'><pre>array([               0,    3600000000000,    7200000000000, ...,
       2667600000000000, 2671200000000000, 2674800000000000],
      dtype=&#x27;timedelta64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-04b38341-56d9-424f-8746-e7a9dd9e3cd1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-04b38341-56d9-424f-8746-e7a9dd9e3cd1' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>ANALYSIS time from 20201201</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>First, from the <code class="docutils literal notranslate"><span class="pre">long_name</span></code> information of the time dimension (see above), we can retrieve the initial timestamp. With the function <code class="docutils literal notranslate"><span class="pre">strptime()</span></code> from Python’s <code class="docutils literal notranslate"><span class="pre">datetime</span></code> library, we can convert it into a <code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">eaqi_london</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">long_name</span><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">]</span>

<span class="n">timestamp_init</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">timestamp</span><span class="p">,</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="p">)</span>
<span class="n">timestamp_init</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>datetime.datetime(2020, 12, 1, 0, 0)
</pre></div>
</div>
</div>
</div>
<p>In a next step, we then build a <code class="docutils literal notranslate"><span class="pre">DateTimeIndex</span></code> object with the help of Panda’s <code class="docutils literal notranslate"><span class="pre">date_range()</span></code> function, making use of the length of the time dimension. The result is a <code class="docutils literal notranslate"><span class="pre">DateTimeIndex</span></code> object, which can be used to newly assign the time coordinate information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_coords</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">timestamp_init</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">eaqi_london</span><span class="o">.</span><span class="n">time</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;1h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">)</span>
<span class="n">time_coords</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DatetimeIndex([&#39;2020-12-01 00:00:00&#39;, &#39;2020-12-01 01:00:00&#39;,
               &#39;2020-12-01 02:00:00&#39;, &#39;2020-12-01 03:00:00&#39;,
               &#39;2020-12-01 04:00:00&#39;, &#39;2020-12-01 05:00:00&#39;,
               &#39;2020-12-01 06:00:00&#39;, &#39;2020-12-01 07:00:00&#39;,
               &#39;2020-12-01 08:00:00&#39;, &#39;2020-12-01 09:00:00&#39;,
               ...
               &#39;2020-12-31 14:00:00&#39;, &#39;2020-12-31 15:00:00&#39;,
               &#39;2020-12-31 16:00:00&#39;, &#39;2020-12-31 17:00:00&#39;,
               &#39;2020-12-31 18:00:00&#39;, &#39;2020-12-31 19:00:00&#39;,
               &#39;2020-12-31 20:00:00&#39;, &#39;2020-12-31 21:00:00&#39;,
               &#39;2020-12-31 22:00:00&#39;, &#39;2020-12-31 23:00:00&#39;],
              dtype=&#39;datetime64[ns]&#39;, length=744, freq=None)
</pre></div>
</div>
</div>
</div>
<p>And the last step is to assign the converted time information to the loaded xarray.Dataset <code class="docutils literal notranslate"><span class="pre">eaqi_ldn_ts</span></code>, with the function <code class="docutils literal notranslate"><span class="pre">assign_coords()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_london</span> <span class="o">=</span> <span class="n">eaqi_london</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time_coords</span><span class="p">)</span>
<span class="n">eaqi_london</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 3, level: 1, longitude: 3, time: 744)
Coordinates:
  * longitude   (longitude) float32 359.8 359.9 360.0
  * latitude    (latitude) float32 51.55 51.45 51.35
  * level       (level) float32 0.0
  * time        (time) datetime64[ns] 2020-12-01 ... 2020-12-31T23:00:00
Data variables:
    no2_conc    (time, level, latitude, longitude) float32 15.51 10.58 ... 46.72
    o3_conc     (time, level, latitude, longitude) float32 37.22 36.29 ... 1.924
    pm10_conc   (time, level, latitude, longitude) float32 9.667 10.13 ... 19.78
    pm2p5_conc  (time, level, latitude, longitude) float32 8.624 9.112 ... 18.0
    so2_conc    (time, level, latitude, longitude) float32 2.99 3.44 ... 11.16
Attributes:
    title:        NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface
    institution:  Data produced by RIUUK
    source:       Data from EURAD-IM model
    history:      Model EURAD ANALYSIS
    ANALYSIS:     Europe, 20201201-20201231+[0H_23H]
    summary:      EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concent...
    project:      MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-aa3925b8-2743-463b-acee-0e283b2d4b91' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-aa3925b8-2743-463b-acee-0e283b2d4b91' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 3</li><li><span class='xr-has-index'>level</span>: 1</li><li><span class='xr-has-index'>longitude</span>: 3</li><li><span class='xr-has-index'>time</span>: 744</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b2b867f1-215b-4d30-93e9-25bc8347ded5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b2b867f1-215b-4d30-93e9-25bc8347ded5' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>359.8 359.9 360.0</div><input id='attrs-ade3d7c0-b8fa-4ba5-b0fd-674496e1f089' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ade3d7c0-b8fa-4ba5-b0fd-674496e1f089' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c638b7b-1f4b-42a6-9088-4cdac62f9b56' class='xr-var-data-in' type='checkbox'><label for='data-6c638b7b-1f4b-42a6-9088-4cdac62f9b56' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([359.75, 359.85, 359.95], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>51.55 51.45 51.35</div><input id='attrs-27d76e7b-4b24-4ed3-afe6-7cd2dc96e0a8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-27d76e7b-4b24-4ed3-afe6-7cd2dc96e0a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-15c28859-13d0-48f2-9114-d92769e68b0d' class='xr-var-data-in' type='checkbox'><label for='data-15c28859-13d0-48f2-9114-d92769e68b0d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([51.55, 51.45, 51.35], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-ddeb63c5-8bfb-464e-841d-fb4c0f6044f0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ddeb63c5-8bfb-464e-841d-fb4c0f6044f0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a783650-666b-4244-8f1c-9c07edd87160' class='xr-var-data-in' type='checkbox'><label for='data-6a783650-666b-4244-8f1c-9c07edd87160' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-12-01 ... 2020-12-31T23:00:00</div><input id='attrs-e8a9f76c-09b4-455c-a30f-0cb745067461' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e8a9f76c-09b4-455c-a30f-0cb745067461' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-65e880b4-94ba-4b7c-b8a6-f716d20f4352' class='xr-var-data-in' type='checkbox'><label for='data-65e880b4-94ba-4b7c-b8a6-f716d20f4352' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-12-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T01:00:00.000000000&#x27;,
       &#x27;2020-12-01T02:00:00.000000000&#x27;, ..., &#x27;2020-12-31T21:00:00.000000000&#x27;,
       &#x27;2020-12-31T22:00:00.000000000&#x27;, &#x27;2020-12-31T23:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a5f0ce5e-93c0-4a14-b159-d31ce4617dff' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a5f0ce5e-93c0-4a14-b159-d31ce4617dff' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>15.51 10.58 18.17 ... 49.02 46.72</div><input id='attrs-e96b2373-fc45-4318-9e2b-839b565ba933' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e96b2373-fc45-4318-9e2b-839b565ba933' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-612940f0-7e3a-4ea1-9244-a16151bcbc9f' class='xr-var-data-in' type='checkbox'><label for='data-612940f0-7e3a-4ea1-9244-a16151bcbc9f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Nitrogen Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_nitrogen_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[15.510345, ..., 18.174795],
         ...,
         [22.29408 , ..., 20.352665]]],


       ...,


       [[[36.479404, ..., 35.76146 ],
         ...,
         [55.333344, ..., 46.718143]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>37.22 36.29 37.4 ... 2.409 1.924</div><input id='attrs-a60d4cbd-ce24-4421-a76e-fa98224a9719' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a60d4cbd-ce24-4421-a76e-fa98224a9719' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9621fe80-087e-40c9-b61c-116060f8c86d' class='xr-var-data-in' type='checkbox'><label for='data-9621fe80-087e-40c9-b61c-116060f8c86d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Ozone</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_ozone_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[37.22002 , ..., 37.39592 ],
         ...,
         [32.99458 , ..., 32.783318]]],


       ...,


       [[[17.871344, ..., 16.65876 ],
         ...,
         [ 2.548177, ...,  1.923809]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>9.667 10.13 10.22 ... 19.35 19.78</div><input id='attrs-cc2e5bf5-788d-4817-a3ff-e2cd0a87e106' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cc2e5bf5-788d-4817-a3ff-e2cd0a87e106' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c2a4c07-e6c6-4b28-91a2-0b160f832c71' class='xr-var-data-in' type='checkbox'><label for='data-0c2a4c07-e6c6-4b28-91a2-0b160f832c71' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM10 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 9.666528, ..., 10.224049],
         ...,
         [ 9.492814, ..., 10.637783]]],


       ...,


       [[[20.009241, ..., 21.280088],
         ...,
         [18.24215 , ..., 19.779423]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>8.624 9.112 9.175 ... 17.46 18.0</div><input id='attrs-1848a3a9-3343-4055-a75d-9fbca0867c2b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1848a3a9-3343-4055-a75d-9fbca0867c2b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff427197-c0e6-4ad9-9ca5-025ac0f1f27a' class='xr-var-data-in' type='checkbox'><label for='data-ff427197-c0e6-4ad9-9ca5-025ac0f1f27a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM2.5 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 8.624495, ...,  9.175108],
         ...,
         [ 8.614178, ...,  9.701087]]],


       ...,


       [[[16.95187 , ..., 18.536068],
         ...,
         [16.331594, ..., 17.998186]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.99 3.44 3.667 ... 10.33 11.16</div><input id='attrs-edf31f00-2edc-4a36-8e8e-1cbcf7244fe3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-edf31f00-2edc-4a36-8e8e-1cbcf7244fe3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a5eb9f47-687a-4185-8faa-e04d7afd2e28' class='xr-var-data-in' type='checkbox'><label for='data-a5eb9f47-687a-4185-8faa-e04d7afd2e28' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Sulphur Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_sulfur_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 2.990305, ...,  3.666514],
         ...,
         [ 3.343928, ...,  4.098411]]],


       ...,


       [[[ 7.277549, ...,  8.871666],
         ...,
         [ 8.752181, ..., 11.158818]]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5926009b-575f-4cd1-a877-8ec5a59084b2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5926009b-575f-4cd1-a877-8ec5a59084b2' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface</dd><dt><span>institution :</span></dt><dd>Data produced by RIUUK</dd><dt><span>source :</span></dt><dd>Data from EURAD-IM model</dd><dt><span>history :</span></dt><dd>Model EURAD ANALYSIS</dd><dt><span>ANALYSIS :</span></dt><dd>Europe, 20201201-20201231+[0H_23H]</dd><dt><span>summary :</span></dt><dd>EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concentration at the Surface from 20201201-20201231+[0H_23H] on Europe</dd><dt><span>project :</span></dt><dd>MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Now, let us also re-assign the longitude values and shift the grid from [0,360] to [-180,180]. At the end, you might want to sort the longitude values in an ascending order. You can re-assign coordinate values with the xarray function <code class="docutils literal notranslate"><span class="pre">assign_coords()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_london_assigned</span> <span class="o">=</span> <span class="n">eaqi_london</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="p">(((</span><span class="n">eaqi_london</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span><span class="p">))</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
<span class="n">eaqi_london_assigned</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 3, level: 1, longitude: 3, time: 744)
Coordinates:
  * longitude   (longitude) float32 -0.25 -0.15 -0.04999
  * latitude    (latitude) float32 51.55 51.45 51.35
  * level       (level) float32 0.0
  * time        (time) datetime64[ns] 2020-12-01 ... 2020-12-31T23:00:00
Data variables:
    no2_conc    (time, level, latitude, longitude) float32 15.51 10.58 ... 46.72
    o3_conc     (time, level, latitude, longitude) float32 37.22 36.29 ... 1.924
    pm10_conc   (time, level, latitude, longitude) float32 9.667 10.13 ... 19.78
    pm2p5_conc  (time, level, latitude, longitude) float32 8.624 9.112 ... 18.0
    so2_conc    (time, level, latitude, longitude) float32 2.99 3.44 ... 11.16
Attributes:
    title:        NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface
    institution:  Data produced by RIUUK
    source:       Data from EURAD-IM model
    history:      Model EURAD ANALYSIS
    ANALYSIS:     Europe, 20201201-20201231+[0H_23H]
    summary:      EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concent...
    project:      MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-c4f9f45b-9286-40e2-8468-39ebe1f0e778' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c4f9f45b-9286-40e2-8468-39ebe1f0e778' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 3</li><li><span class='xr-has-index'>level</span>: 1</li><li><span class='xr-has-index'>longitude</span>: 3</li><li><span class='xr-has-index'>time</span>: 744</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7753be9a-d9a4-42e9-8658-83250a1804f1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7753be9a-d9a4-42e9-8658-83250a1804f1' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.25 -0.15 -0.04999</div><input id='attrs-bac20b30-9787-496f-808b-1c539be5eafe' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bac20b30-9787-496f-808b-1c539be5eafe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3fc66ada-b6b0-41e3-9c67-cafb68d9be92' class='xr-var-data-in' type='checkbox'><label for='data-3fc66ada-b6b0-41e3-9c67-cafb68d9be92' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-0.25    , -0.150024, -0.049988], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>51.55 51.45 51.35</div><input id='attrs-86563f06-a07b-4fc3-9b6b-8904c904b80c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-86563f06-a07b-4fc3-9b6b-8904c904b80c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-201524af-e84d-41fc-9288-bedb389ef61f' class='xr-var-data-in' type='checkbox'><label for='data-201524af-e84d-41fc-9288-bedb389ef61f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([51.55, 51.45, 51.35], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-73369f9e-c084-49ef-b0cf-0041fe569d88' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-73369f9e-c084-49ef-b0cf-0041fe569d88' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b50d0719-53ea-43b3-ab6b-87e684345dcd' class='xr-var-data-in' type='checkbox'><label for='data-b50d0719-53ea-43b3-ab6b-87e684345dcd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>level</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>array([0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-12-01 ... 2020-12-31T23:00:00</div><input id='attrs-fc080290-c3e0-43da-9528-e409620043df' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fc080290-c3e0-43da-9528-e409620043df' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3728071-8710-4522-a5e6-c5b586b13f3d' class='xr-var-data-in' type='checkbox'><label for='data-b3728071-8710-4522-a5e6-c5b586b13f3d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-12-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T01:00:00.000000000&#x27;,
       &#x27;2020-12-01T02:00:00.000000000&#x27;, ..., &#x27;2020-12-31T21:00:00.000000000&#x27;,
       &#x27;2020-12-31T22:00:00.000000000&#x27;, &#x27;2020-12-31T23:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b0a557e1-255f-4d7c-9ff1-3cd5b2923604' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b0a557e1-255f-4d7c-9ff1-3cd5b2923604' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>15.51 10.58 18.17 ... 49.02 46.72</div><input id='attrs-8821a1b9-cdf1-4b83-b382-264836068f54' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8821a1b9-cdf1-4b83-b382-264836068f54' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-87b63cde-e4b5-4dc6-b9de-ad5e8f7c69b7' class='xr-var-data-in' type='checkbox'><label for='data-87b63cde-e4b5-4dc6-b9de-ad5e8f7c69b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Nitrogen Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_nitrogen_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[15.510345, ..., 18.174795],
         ...,
         [22.29408 , ..., 20.352665]]],


       ...,


       [[[36.479404, ..., 35.76146 ],
         ...,
         [55.333344, ..., 46.718143]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>37.22 36.29 37.4 ... 2.409 1.924</div><input id='attrs-681959a8-cf80-4808-b656-876d2f113290' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-681959a8-cf80-4808-b656-876d2f113290' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e9d391c0-ac70-4cbe-80da-bddeeb10f2af' class='xr-var-data-in' type='checkbox'><label for='data-e9d391c0-ac70-4cbe-80da-bddeeb10f2af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Ozone</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_ozone_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[37.22002 , ..., 37.39592 ],
         ...,
         [32.99458 , ..., 32.783318]]],


       ...,


       [[[17.871344, ..., 16.65876 ],
         ...,
         [ 2.548177, ...,  1.923809]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>9.667 10.13 10.22 ... 19.35 19.78</div><input id='attrs-ac8bc02c-0c16-4d19-b8b8-c78c2c888b0e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ac8bc02c-0c16-4d19-b8b8-c78c2c888b0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf61ba49-d79a-4234-ba35-981c80cdcc67' class='xr-var-data-in' type='checkbox'><label for='data-bf61ba49-d79a-4234-ba35-981c80cdcc67' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM10 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 9.666528, ..., 10.224049],
         ...,
         [ 9.492814, ..., 10.637783]]],


       ...,


       [[[20.009241, ..., 21.280088],
         ...,
         [18.24215 , ..., 19.779423]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>8.624 9.112 9.175 ... 17.46 18.0</div><input id='attrs-1a845e6d-a5c4-41eb-82a9-12ad0f021a71' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1a845e6d-a5c4-41eb-82a9-12ad0f021a71' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-48fa99bc-f1d3-4b51-9af4-a4dc00b356e8' class='xr-var-data-in' type='checkbox'><label for='data-48fa99bc-f1d3-4b51-9af4-a4dc00b356e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM2.5 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 8.624495, ...,  9.175108],
         ...,
         [ 8.614178, ...,  9.701087]]],


       ...,


       [[[16.95187 , ..., 18.536068],
         ...,
         [16.331594, ..., 17.998186]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time, level, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.99 3.44 3.667 ... 10.33 11.16</div><input id='attrs-bbdcd562-8672-47d6-938d-bd93d9edc47c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bbdcd562-8672-47d6-938d-bd93d9edc47c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d4b7607-5f40-495e-af87-e53219f97bb5' class='xr-var-data-in' type='checkbox'><label for='data-3d4b7607-5f40-495e-af87-e53219f97bb5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Sulphur Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_sulfur_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 2.990305, ...,  3.666514],
         ...,
         [ 3.343928, ...,  4.098411]]],


       ...,


       [[[ 7.277549, ...,  8.871666],
         ...,
         [ 8.752181, ..., 11.158818]]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c0df9d43-9e44-4f2a-b2ff-1e23aa17489c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c0df9d43-9e44-4f2a-b2ff-1e23aa17489c' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface</dd><dt><span>institution :</span></dt><dd>Data produced by RIUUK</dd><dt><span>source :</span></dt><dd>Data from EURAD-IM model</dd><dt><span>history :</span></dt><dd>Model EURAD ANALYSIS</dd><dt><span>ANALYSIS :</span></dt><dd>Europe, 20201201-20201231+[0H_23H]</dd><dt><span>summary :</span></dt><dd>EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concentration at the Surface from 20201201-20201231+[0H_23H] on Europe</dd><dt><span>project :</span></dt><dd>MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Let us now also drop the dimension <code class="docutils literal notranslate"><span class="pre">level</span></code>, which only has one record, as we requested the data of the five key pollutants on the surface. The xarray function <code class="docutils literal notranslate"><span class="pre">squeeze()</span></code> drops all dimensions with only one entry. The result is a dataset with three dimensions: <code class="docutils literal notranslate"><span class="pre">latitude</span></code>, <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_london_assigned</span> <span class="o">=</span> <span class="n">eaqi_london_assigned</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">eaqi_london_assigned</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (latitude: 3, longitude: 3, time: 744)
Coordinates:
  * longitude   (longitude) float32 -0.25 -0.15 -0.04999
  * latitude    (latitude) float32 51.55 51.45 51.35
  * time        (time) datetime64[ns] 2020-12-01 ... 2020-12-31T23:00:00
Data variables:
    no2_conc    (time, latitude, longitude) float32 15.51 10.58 ... 49.02 46.72
    o3_conc     (time, latitude, longitude) float32 37.22 36.29 ... 2.409 1.924
    pm10_conc   (time, latitude, longitude) float32 9.667 10.13 ... 19.35 19.78
    pm2p5_conc  (time, latitude, longitude) float32 8.624 9.112 ... 17.46 18.0
    so2_conc    (time, latitude, longitude) float32 2.99 3.44 ... 10.33 11.16
Attributes:
    title:        NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface
    institution:  Data produced by RIUUK
    source:       Data from EURAD-IM model
    history:      Model EURAD ANALYSIS
    ANALYSIS:     Europe, 20201201-20201231+[0H_23H]
    summary:      EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concent...
    project:      MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d98c097e-08b2-430e-8b7c-a78bcbb5fe05' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d98c097e-08b2-430e-8b7c-a78bcbb5fe05' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latitude</span>: 3</li><li><span class='xr-has-index'>longitude</span>: 3</li><li><span class='xr-has-index'>time</span>: 744</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-fa4e5fb0-6e95-4ae5-854e-5703ae399b59' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fa4e5fb0-6e95-4ae5-854e-5703ae399b59' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.25 -0.15 -0.04999</div><input id='attrs-ef64ac75-be31-4bd6-89a4-16e8ef90dd70' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ef64ac75-be31-4bd6-89a4-16e8ef90dd70' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8dc2e742-7d73-4913-8176-fb8b0832dba4' class='xr-var-data-in' type='checkbox'><label for='data-8dc2e742-7d73-4913-8176-fb8b0832dba4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-0.25    , -0.150024, -0.049988], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>51.55 51.45 51.35</div><input id='attrs-c34245b9-1ff6-4348-b334-e7d9efb5bd52' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c34245b9-1ff6-4348-b334-e7d9efb5bd52' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-61783095-55ee-4376-9280-a5d68b644fb8' class='xr-var-data-in' type='checkbox'><label for='data-61783095-55ee-4376-9280-a5d68b644fb8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([51.55, 51.45, 51.35], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-12-01 ... 2020-12-31T23:00:00</div><input id='attrs-5a2eefc5-d4fa-41ac-a4fd-f55a66597d53' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5a2eefc5-d4fa-41ac-a4fd-f55a66597d53' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7bc20712-b92e-48bc-9f5a-a61fda88862b' class='xr-var-data-in' type='checkbox'><label for='data-7bc20712-b92e-48bc-9f5a-a61fda88862b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-12-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T01:00:00.000000000&#x27;,
       &#x27;2020-12-01T02:00:00.000000000&#x27;, ..., &#x27;2020-12-31T21:00:00.000000000&#x27;,
       &#x27;2020-12-31T22:00:00.000000000&#x27;, &#x27;2020-12-31T23:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-92c8e64c-fd61-4db5-b5d0-f6a929f037a6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-92c8e64c-fd61-4db5-b5d0-f6a929f037a6' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>15.51 10.58 18.17 ... 49.02 46.72</div><input id='attrs-163cec59-8148-4dc7-8a5f-50faea2379e6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-163cec59-8148-4dc7-8a5f-50faea2379e6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3221d3ba-e3ae-42a6-827b-f160579f9596' class='xr-var-data-in' type='checkbox'><label for='data-3221d3ba-e3ae-42a6-827b-f160579f9596' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Nitrogen Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_nitrogen_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[15.510345, 10.579534, 18.174795],
        [20.994917, 18.346903, 22.862679],
        [22.29408 , 21.535889, 20.352665]],

       [[13.2516  ,  8.708938, 13.546945],
        [18.658539, 14.884748, 17.36678 ],
        [20.586605, 18.495684, 17.110401]],

       ...,

       [[33.60502 , 18.792007, 38.690742],
        [50.68169 , 36.13545 , 40.703144],
        [57.09093 , 50.720074, 47.777363]],

       [[36.479404, 25.34729 , 35.76146 ],
        [49.230564, 35.99857 , 39.039207],
        [55.333344, 49.02131 , 46.718143]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>37.22 36.29 37.4 ... 2.409 1.924</div><input id='attrs-9ed9a933-03a2-4918-8bd6-1ed4ef70a737' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9ed9a933-03a2-4918-8bd6-1ed4ef70a737' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-917ca019-f77a-4658-819e-7a31d5ab517a' class='xr-var-data-in' type='checkbox'><label for='data-917ca019-f77a-4658-819e-7a31d5ab517a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Ozone</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_ozone_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[37.22002 , 36.288414, 37.39592 ],
        [32.87107 , 30.231646, 29.552027],
        [32.99458 , 32.758266, 32.783318]],

       [[45.106533, 46.573887, 47.846783],
        [39.874947, 40.614536, 41.431847],
        [37.11564 , 38.48072 , 39.64118 ]],

       ...,

       [[21.514835, 31.547274, 14.364104],
        [ 6.591847, 11.323124,  7.030365],
        [ 1.501007,  2.097181,  2.34354 ]],

       [[17.871344, 27.412085, 16.65876 ],
        [ 7.608634, 12.21619 ,  8.43275 ],
        [ 2.548177,  2.408655,  1.923809]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>9.667 10.13 10.22 ... 19.35 19.78</div><input id='attrs-a22c78e5-b2ad-49fc-87e5-ed156dee18dd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a22c78e5-b2ad-49fc-87e5-ed156dee18dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7976b8b-1c49-46a7-9e96-78c3d86f94bc' class='xr-var-data-in' type='checkbox'><label for='data-a7976b8b-1c49-46a7-9e96-78c3d86f94bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM10 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[ 9.666528, 10.134321, 10.224049],
        [ 9.93193 , 11.177739, 11.461103],
        [ 9.492814, 10.298428, 10.637783]],

       [[ 8.71655 ,  8.762962,  8.572779],
        [ 9.382599, 10.342698, 10.400551],
        [ 9.995328, 10.667473, 10.90721 ]],

       ...,

       [[19.123522, 20.140621, 20.78949 ],
        [18.499098, 19.941158, 20.598553],
        [16.874968, 17.37354 , 17.563284]],

       [[20.009241, 20.410782, 21.280088],
        [19.186546, 21.101486, 22.031332],
        [18.24215 , 19.353893, 19.779423]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>8.624 9.112 9.175 ... 17.46 18.0</div><input id='attrs-c62b8798-0ab1-4e95-8a54-827d53272e54' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c62b8798-0ab1-4e95-8a54-827d53272e54' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-13f49ad3-76eb-41c9-acde-aa3c862d1a86' class='xr-var-data-in' type='checkbox'><label for='data-13f49ad3-76eb-41c9-acde-aa3c862d1a86' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM2.5 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[ 8.624495,  9.111983,  9.175108],
        [ 8.910218, 10.065255, 10.328034],
        [ 8.614178,  9.357618,  9.701087]],

       [[ 7.747547,  7.855393,  7.650344],
        [ 8.371894,  9.294804,  9.34192 ],
        [ 9.043769,  9.675157,  9.929397]],

       ...,

       [[16.371088, 17.581823, 18.21415 ],
        [16.062485, 17.593449, 18.26474 ],
        [15.012928, 15.503884, 15.781394]],

       [[16.95187 , 17.51425 , 18.536068],
        [16.613737, 18.597458, 19.570078],
        [16.331594, 17.455702, 17.998186]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.99 3.44 3.667 ... 10.33 11.16</div><input id='attrs-26db0650-3817-4d98-9fe6-d406c8481518' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-26db0650-3817-4d98-9fe6-d406c8481518' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-820104aa-1799-4fef-94c1-f148f32c9645' class='xr-var-data-in' type='checkbox'><label for='data-820104aa-1799-4fef-94c1-f148f32c9645' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Sulphur Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_sulfur_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([[[ 2.990305,  3.440334,  3.666514],
        [ 3.569994,  4.487958,  4.805997],
        [ 3.343928,  3.8807  ,  4.098411]],

       [[ 2.548347,  2.805848,  3.030266],
        [ 3.150262,  3.59762 ,  3.752746],
        [ 3.091941,  3.374168,  3.476543]],

       ...,

       [[ 7.829386,  9.040606,  9.668385],
        [ 9.034239, 11.045587, 11.954286],
        [ 8.767416, 10.257509, 10.950203]],

       [[ 7.277549,  8.221832,  8.871666],
        [ 8.627126, 10.639724, 11.633574],
        [ 8.752181, 10.331519, 11.158818]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2712da8f-a4b1-430a-8b86-6e646a53af24' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2712da8f-a4b1-430a-8b86-6e646a53af24' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface</dd><dt><span>institution :</span></dt><dd>Data produced by RIUUK</dd><dt><span>source :</span></dt><dd>Data from EURAD-IM model</dd><dt><span>history :</span></dt><dd>Model EURAD ANALYSIS</dd><dt><span>ANALYSIS :</span></dt><dd>Europe, 20201201-20201231+[0H_23H]</dd><dt><span>summary :</span></dt><dd>EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concentration at the Surface from 20201201-20201231+[0H_23H] on Europe</dd><dt><span>project :</span></dt><dd>MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</dd></dl></div></li></ul></div></div></div></div>
</div>
<br></div>
<div class="section" id="select-time-series-information-for-london-uk-and-convert-to-a-pandas-dataframe">
<h3>2.3 Select time-series information for London, UK and convert to a pandas dataframe<a class="headerlink" href="#select-time-series-information-for-london-uk-and-convert-to-a-pandas-dataframe" title="Permalink to this headline">¶</a></h3>
<p>The xarray.Dataset above is now in a format that allows us to select the values of the pollutants for one single grid point. Let us first define variables for the latitude and longitude coordinates for London, United Kingdom. These two variables can then be used to select the values for one single grid point. You can use xarray’s function <code class="docutils literal notranslate"><span class="pre">sel()</span></code> to make a coordinate-based selection. Let us set the keyword argument <code class="docutils literal notranslate"><span class="pre">method='nearest'</span></code>, which selects the information that belongs to the closest grid point to the provided latitude and longitude inputs.</p>
<p>The resulting dataset remains with <code class="docutils literal notranslate"><span class="pre">time</span></code> as the only dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">london_lat</span> <span class="o">=</span> <span class="mf">51.5</span>
<span class="n">london_lon</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>

<span class="n">eaqi_ldn_ts</span> <span class="o">=</span> <span class="n">eaqi_london_assigned</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="n">london_lat</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="n">london_lon</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">eaqi_ldn_ts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (time: 744)
Coordinates:
    longitude   float32 -0.04999
    latitude    float32 51.55
  * time        (time) datetime64[ns] 2020-12-01 ... 2020-12-31T23:00:00
Data variables:
    no2_conc    (time) float32 18.17 13.55 10.95 11.06 ... 40.85 38.69 35.76
    o3_conc     (time) float32 37.4 47.85 51.77 51.07 ... 14.49 14.36 16.66
    pm10_conc   (time) float32 10.22 8.573 7.056 6.757 ... 19.02 20.79 21.28
    pm2p5_conc  (time) float32 9.175 7.65 6.211 5.926 ... 16.62 18.21 18.54
    so2_conc    (time) float32 3.667 3.03 2.836 2.631 ... 9.585 9.668 8.872
Attributes:
    title:        NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface
    institution:  Data produced by RIUUK
    source:       Data from EURAD-IM model
    history:      Model EURAD ANALYSIS
    ANALYSIS:     Europe, 20201201-20201231+[0H_23H]
    summary:      EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concent...
    project:      MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2f438cb0-f30b-43bd-9892-10196112064c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2f438cb0-f30b-43bd-9892-10196112064c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 744</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f71a3600-b8a8-4874-bb30-38617b86aade' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f71a3600-b8a8-4874-bb30-38617b86aade' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.04999</div><input id='attrs-8f5c32bd-a885-4870-a5ba-9d7a62cf0203' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8f5c32bd-a885-4870-a5ba-9d7a62cf0203' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d22433a9-40ba-4a36-afc4-cf8f37d789eb' class='xr-var-data-in' type='checkbox'><label for='data-d22433a9-40ba-4a36-afc4-cf8f37d789eb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-0.04998779, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>51.55</div><input id='attrs-46846ed3-cadc-403d-8a7c-c990aa7b1be0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-46846ed3-cadc-403d-8a7c-c990aa7b1be0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-46de8844-2bc6-4d0a-a61a-99bd3aa3b5f1' class='xr-var-data-in' type='checkbox'><label for='data-46de8844-2bc6-4d0a-a61a-99bd3aa3b5f1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array(51.55, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-12-01 ... 2020-12-31T23:00:00</div><input id='attrs-08cd86c1-3f6b-452f-8f11-9ab7c22cb3ae' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-08cd86c1-3f6b-452f-8f11-9ab7c22cb3ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b10b809b-43a1-4573-ad57-302739a3f00f' class='xr-var-data-in' type='checkbox'><label for='data-b10b809b-43a1-4573-ad57-302739a3f00f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-12-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T01:00:00.000000000&#x27;,
       &#x27;2020-12-01T02:00:00.000000000&#x27;, ..., &#x27;2020-12-31T21:00:00.000000000&#x27;,
       &#x27;2020-12-31T22:00:00.000000000&#x27;, &#x27;2020-12-31T23:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b851afd9-305b-4437-aa0e-eec2e7dabf52' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b851afd9-305b-4437-aa0e-eec2e7dabf52' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>18.17 13.55 10.95 ... 38.69 35.76</div><input id='attrs-1285b262-8937-43de-9dfd-4e23c68e6ecf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1285b262-8937-43de-9dfd-4e23c68e6ecf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36bb5574-c067-42ba-aff1-4133224ac4d2' class='xr-var-data-in' type='checkbox'><label for='data-36bb5574-c067-42ba-aff1-4133224ac4d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Nitrogen Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_nitrogen_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([18.174795, 13.546945, 10.945883, ..., 40.848576, 38.690742, 35.76146 ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>37.4 47.85 51.77 ... 14.36 16.66</div><input id='attrs-36165cc1-1f6b-4a79-ae0d-49910e69a923' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-36165cc1-1f6b-4a79-ae0d-49910e69a923' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5f8e768a-cbc4-4a36-92ab-289621ddb6c2' class='xr-var-data-in' type='checkbox'><label for='data-5f8e768a-cbc4-4a36-92ab-289621ddb6c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Ozone</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_ozone_in_air</dd></dl></div><div class='xr-var-data'><pre>array([37.39592 , 47.846783, 51.769108, ..., 14.485551, 14.364104, 16.65876 ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>10.22 8.573 7.056 ... 20.79 21.28</div><input id='attrs-108e1de4-6123-4953-bf37-63362b11da4d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-108e1de4-6123-4953-bf37-63362b11da4d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc9cb8f0-7856-4f05-8a04-02d5a6ffc2c1' class='xr-var-data-in' type='checkbox'><label for='data-bc9cb8f0-7856-4f05-8a04-02d5a6ffc2c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM10 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm10_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([10.224049,  8.572779,  7.05563 , ..., 19.01986 , 20.78949 , 21.280088],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>9.175 7.65 6.211 ... 18.21 18.54</div><input id='attrs-6c32d800-1f6e-4589-95c4-4f91812894cb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6c32d800-1f6e-4589-95c4-4f91812894cb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9acc58b2-12b5-46ab-a24d-b8ec28bd6a81' class='xr-var-data-in' type='checkbox'><label for='data-9acc58b2-12b5-46ab-a24d-b8ec28bd6a81' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>PM2.5 Aerosol</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_pm2p5_ambient_aerosol_in_air</dd></dl></div><div class='xr-var-data'><pre>array([ 9.175108,  7.650344,  6.210651, ..., 16.623259, 18.21415 , 18.536068],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>3.667 3.03 2.836 ... 9.668 8.872</div><input id='attrs-f3360ac6-89c8-4f57-9095-069da23d2af4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f3360ac6-89c8-4f57-9095-069da23d2af4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ad49141a-4ff6-4c4f-b5bf-e2ecd4e6ecb5' class='xr-var-data-in' type='checkbox'><label for='data-ad49141a-4ff6-4c4f-b5bf-e2ecd4e6ecb5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>species :</span></dt><dd>Sulphur Dioxide</dd><dt><span>units :</span></dt><dd>µg/m3</dd><dt><span>value :</span></dt><dd>hourly values</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_sulfur_dioxide_in_air</dd></dl></div><div class='xr-var-data'><pre>array([3.666514, 3.030266, 2.836089, ..., 9.584825, 9.668385, 8.871666],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-19b83af4-5615-4e78-aa22-d59ad50ad096' class='xr-section-summary-in' type='checkbox'  checked><label for='section-19b83af4-5615-4e78-aa22-d59ad50ad096' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>NO2/O3/PM10/PM25/SO2 Air Pollutant ANALYSIS at the Surface</dd><dt><span>institution :</span></dt><dd>Data produced by RIUUK</dd><dt><span>source :</span></dt><dd>Data from EURAD-IM model</dd><dt><span>history :</span></dt><dd>Model EURAD ANALYSIS</dd><dt><span>ANALYSIS :</span></dt><dd>Europe, 20201201-20201231+[0H_23H]</dd><dt><span>summary :</span></dt><dd>EURAD model hourly ANALYSIS of NO2/O3/PM10/PM25/SO2 concentration at the Surface from 20201201-20201231+[0H_23H] on Europe</dd><dt><span>project :</span></dt><dd>MACC-RAQ (http://macc-raq.gmes-atmosphere.eu)</dd></dl></div></li></ul></div></div></div></div>
</div>
<br><p>Our aim is to compute the daily European Air Quality Index for London for every day in December 2020. Hence, as a next step we want to resample the hourly data to a daily resolution. As resample function, we use <code class="docutils literal notranslate"><span class="pre">max()</span></code>, which selects for every key pollutant the maximum value per day. You can use the function <code class="docutils literal notranslate"><span class="pre">resample()</span></code> to aggregated the hourly information to daily maximum values. The result is a decrease of the time dimension entries from 744 to 31, one entry for every day in December 2020.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_lnd_ts_daily</span> <span class="o">=</span> <span class="n">eaqi_ldn_ts</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">eaqi_lnd_ts_daily</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (time: 31)
Coordinates:
  * time        (time) datetime64[ns] 2020-12-01 2020-12-02 ... 2020-12-31
    longitude   float32 -0.04999
    latitude    float32 51.55
Data variables:
    no2_conc    (time) float64 36.3 65.69 70.01 66.55 ... 65.24 84.48 52.93
    o3_conc     (time) float64 51.77 24.67 49.51 77.38 ... 32.98 23.57 20.49
    pm10_conc   (time) float64 22.57 50.78 28.98 17.73 ... 41.05 36.28 33.25
    pm2p5_conc  (time) float64 20.82 47.19 26.39 16.21 ... 37.79 32.32 29.52
    so2_conc    (time) float64 8.053 41.21 48.89 18.53 ... 24.58 39.45 15.31</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-81404545-d4cc-4fbc-9f7a-a9352bc2fc13' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-81404545-d4cc-4fbc-9f7a-a9352bc2fc13' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 31</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-af9eaa07-e0dd-44fb-86d8-7e51fc81025f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-af9eaa07-e0dd-44fb-86d8-7e51fc81025f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2020-12-01 ... 2020-12-31</div><input id='attrs-8b1aacdd-c8cb-4668-9db1-54523fb55a4f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8b1aacdd-c8cb-4668-9db1-54523fb55a4f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a639761d-143c-46e3-8c5f-3a04f2ae5235' class='xr-var-data-in' type='checkbox'><label for='data-a639761d-143c-46e3-8c5f-3a04f2ae5235' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2020-12-01T00:00:00.000000000&#x27;, &#x27;2020-12-02T00:00:00.000000000&#x27;,
       &#x27;2020-12-03T00:00:00.000000000&#x27;, &#x27;2020-12-04T00:00:00.000000000&#x27;,
       &#x27;2020-12-05T00:00:00.000000000&#x27;, &#x27;2020-12-06T00:00:00.000000000&#x27;,
       &#x27;2020-12-07T00:00:00.000000000&#x27;, &#x27;2020-12-08T00:00:00.000000000&#x27;,
       &#x27;2020-12-09T00:00:00.000000000&#x27;, &#x27;2020-12-10T00:00:00.000000000&#x27;,
       &#x27;2020-12-11T00:00:00.000000000&#x27;, &#x27;2020-12-12T00:00:00.000000000&#x27;,
       &#x27;2020-12-13T00:00:00.000000000&#x27;, &#x27;2020-12-14T00:00:00.000000000&#x27;,
       &#x27;2020-12-15T00:00:00.000000000&#x27;, &#x27;2020-12-16T00:00:00.000000000&#x27;,
       &#x27;2020-12-17T00:00:00.000000000&#x27;, &#x27;2020-12-18T00:00:00.000000000&#x27;,
       &#x27;2020-12-19T00:00:00.000000000&#x27;, &#x27;2020-12-20T00:00:00.000000000&#x27;,
       &#x27;2020-12-21T00:00:00.000000000&#x27;, &#x27;2020-12-22T00:00:00.000000000&#x27;,
       &#x27;2020-12-23T00:00:00.000000000&#x27;, &#x27;2020-12-24T00:00:00.000000000&#x27;,
       &#x27;2020-12-25T00:00:00.000000000&#x27;, &#x27;2020-12-26T00:00:00.000000000&#x27;,
       &#x27;2020-12-27T00:00:00.000000000&#x27;, &#x27;2020-12-28T00:00:00.000000000&#x27;,
       &#x27;2020-12-29T00:00:00.000000000&#x27;, &#x27;2020-12-30T00:00:00.000000000&#x27;,
       &#x27;2020-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-0.04999</div><input id='attrs-afa18f11-38af-46c1-8a42-4cea77141e13' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-afa18f11-38af-46c1-8a42-4cea77141e13' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed7e0cba-9b46-4a53-a0bb-482758afd05b' class='xr-var-data-in' type='checkbox'><label for='data-ed7e0cba-9b46-4a53-a0bb-482758afd05b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-0.04998779, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>51.55</div><input id='attrs-45c69d9f-21a3-49b8-b847-128375ccc863' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-45c69d9f-21a3-49b8-b847-128375ccc863' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e0e9f1fc-2648-49fd-8e89-4c0c11b58351' class='xr-var-data-in' type='checkbox'><label for='data-e0e9f1fc-2648-49fd-8e89-4c0c11b58351' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array(51.55, dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2db8c8d6-8cd0-4dd7-916d-82f16223c1be' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2db8c8d6-8cd0-4dd7-916d-82f16223c1be' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>no2_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>36.3 65.69 70.01 ... 84.48 52.93</div><input id='attrs-07becd6a-2fd6-456d-8eb6-0d514515bb65' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-07becd6a-2fd6-456d-8eb6-0d514515bb65' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1711d0c8-0d34-4551-8a25-d7cf6b7de955' class='xr-var-data-in' type='checkbox'><label for='data-1711d0c8-0d34-4551-8a25-d7cf6b7de955' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 36.30299377,  65.68988037,  70.01146698,  66.55126953,
        47.04573822,  36.37680435,  57.13370514,  57.63101196,
        64.7775116 ,  43.43681717, 113.46591949,  57.88596344,
        56.97869873,  41.86167526,  54.94801712,  63.9841423 ,
        48.93317413,  21.91687584,  19.73365974,  25.81886673,
        26.26212692,  69.27537537,  51.012043  ,  12.58273888,
        51.90653992,  46.18640137,  71.50334167,  67.38331604,
        65.24152374,  84.48013306,  52.9269371 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>o3_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>51.77 24.67 49.51 ... 23.57 20.49</div><input id='attrs-1e821bea-771b-481f-bb60-2459e1b685b2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1e821bea-771b-481f-bb60-2459e1b685b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31d49e52-a955-46c6-ae95-691a53c5bbec' class='xr-var-data-in' type='checkbox'><label for='data-31d49e52-a955-46c6-ae95-691a53c5bbec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([51.76910782, 24.66534042, 49.51294708, 77.37693787, 55.20477676,
       31.80633736, 19.87851334,  7.21585321, 32.25561905, 44.31040955,
       44.1403656 , 45.81469727, 55.79682922, 75.31567383, 60.60375214,
       56.93139648, 49.17032623, 64.97071838, 81.63644409, 68.82138062,
       55.71593094, 74.09149933, 73.12327576, 80.72418976, 64.10220337,
       69.87267303, 83.72303009, 41.2680397 , 32.98464584, 23.56501579,
       20.48646545])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm10_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>22.57 50.78 28.98 ... 36.28 33.25</div><input id='attrs-4e34ca09-d3db-4132-80ce-0bb4261f5742' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4e34ca09-d3db-4132-80ce-0bb4261f5742' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-210ecae7-fbb7-4ffe-beef-aa0d13d8db11' class='xr-var-data-in' type='checkbox'><label for='data-210ecae7-fbb7-4ffe-beef-aa0d13d8db11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([22.57060051, 50.78494644, 28.97666359, 17.72842407, 19.83301544,
       27.09029961, 42.65241241, 43.27971649, 32.22806168, 19.20415497,
       46.63470078, 30.87269211, 19.65514374, 10.62569714, 12.21476555,
       16.3072834 , 12.91017246,         nan, 12.67010784,  8.51046944,
        9.83042145, 38.75607681, 16.13843155,  5.15066624, 21.04909515,
       17.39035606, 14.51557732, 35.5093956 , 41.04904938, 36.27640152,
       33.24543762])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pm2p5_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>20.82 47.19 26.39 ... 32.32 29.52</div><input id='attrs-0a274193-3a1b-4881-89b4-1e10caf05a0b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0a274193-3a1b-4881-89b4-1e10caf05a0b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34e46362-ed6c-401e-af2e-c1fd8f818cdd' class='xr-var-data-in' type='checkbox'><label for='data-34e46362-ed6c-401e-af2e-c1fd8f818cdd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([20.82224083, 47.19441223, 26.39168358, 16.21479034, 18.2527771 ,
       24.14494705, 40.13755417, 40.59964752, 29.39426804, 17.02283287,
       40.18713379, 25.86927795, 17.98646927,  8.36485767,  9.67144585,
       14.95213985, 10.86158085,         nan, 11.53662968,  6.05193615,
        7.51580477, 33.04491425, 14.70893383,  4.40539551, 19.382658  ,
       16.17809486, 12.41596222, 29.79351234, 37.79423141, 32.32485199,
       29.51881409])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so2_conc</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>8.053 41.21 48.89 ... 39.45 15.31</div><input id='attrs-6abf8411-2e9b-4eff-a837-b7d244030ce5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6abf8411-2e9b-4eff-a837-b7d244030ce5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-995e57d0-8734-4779-97b7-581b1c464ab1' class='xr-var-data-in' type='checkbox'><label for='data-995e57d0-8734-4779-97b7-581b1c464ab1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 8.05340481, 41.21045685, 48.89346695, 18.53280258,  9.04989815,
        8.82772636, 21.6830349 , 25.11410522, 31.41758537, 13.8028326 ,
       49.34526062, 14.57840443, 17.1786499 , 13.11939049, 12.9295187 ,
       25.2906456 , 10.98476315,         nan,  4.22994614,  6.06269169,
        6.2261734 , 25.56100845, 11.81103992,  3.35580802, 15.9163847 ,
        7.16892147, 13.61837578, 18.92266273, 24.57670975, 39.44808197,
       15.31316185])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-341ceb52-2698-49c8-9cc2-33f2373b13a8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-341ceb52-2698-49c8-9cc2-33f2373b13a8' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<br><p>Above, the xarray.Dataset holds the daily time-series information for London for the five main pollutants. The Python library <a class="reference external" href="https://pandas.pydata.org/">pandas</a> is very effective in handling time-series data and offers an interface to xarray. Let us convert the xarray.Dataset above to a pandas.DataFrame with the function <code class="docutils literal notranslate"><span class="pre">to_dataframe()</span></code>. The result is a dataframe with 31 row entries and seven columns, including longitude and latitude information as well as the maximum daily values for each main pollutant.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eaqi_ts_daily_df</span> <span class="o">=</span> <span class="n">eaqi_lnd_ts_daily</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">eaqi_ts_daily_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>longitude</th>
      <th>latitude</th>
      <th>no2_conc</th>
      <th>o3_conc</th>
      <th>pm10_conc</th>
      <th>pm2p5_conc</th>
      <th>so2_conc</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-12-01</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>36.302994</td>
      <td>51.769108</td>
      <td>22.570601</td>
      <td>20.822241</td>
      <td>8.053405</td>
    </tr>
    <tr>
      <th>2020-12-02</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>65.689880</td>
      <td>24.665340</td>
      <td>50.784946</td>
      <td>47.194412</td>
      <td>41.210457</td>
    </tr>
    <tr>
      <th>2020-12-03</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>70.011467</td>
      <td>49.512947</td>
      <td>28.976664</td>
      <td>26.391684</td>
      <td>48.893467</td>
    </tr>
    <tr>
      <th>2020-12-04</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>66.551270</td>
      <td>77.376938</td>
      <td>17.728424</td>
      <td>16.214790</td>
      <td>18.532803</td>
    </tr>
    <tr>
      <th>2020-12-05</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>47.045738</td>
      <td>55.204777</td>
      <td>19.833015</td>
      <td>18.252777</td>
      <td>9.049898</td>
    </tr>
    <tr>
      <th>2020-12-06</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>36.376804</td>
      <td>31.806337</td>
      <td>27.090300</td>
      <td>24.144947</td>
      <td>8.827726</td>
    </tr>
    <tr>
      <th>2020-12-07</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>57.133705</td>
      <td>19.878513</td>
      <td>42.652412</td>
      <td>40.137554</td>
      <td>21.683035</td>
    </tr>
    <tr>
      <th>2020-12-08</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>57.631012</td>
      <td>7.215853</td>
      <td>43.279716</td>
      <td>40.599648</td>
      <td>25.114105</td>
    </tr>
    <tr>
      <th>2020-12-09</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>64.777512</td>
      <td>32.255619</td>
      <td>32.228062</td>
      <td>29.394268</td>
      <td>31.417585</td>
    </tr>
    <tr>
      <th>2020-12-10</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>43.436817</td>
      <td>44.310410</td>
      <td>19.204155</td>
      <td>17.022833</td>
      <td>13.802833</td>
    </tr>
    <tr>
      <th>2020-12-11</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>113.465919</td>
      <td>44.140366</td>
      <td>46.634701</td>
      <td>40.187134</td>
      <td>49.345261</td>
    </tr>
    <tr>
      <th>2020-12-12</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>57.885963</td>
      <td>45.814697</td>
      <td>30.872692</td>
      <td>25.869278</td>
      <td>14.578404</td>
    </tr>
    <tr>
      <th>2020-12-13</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>56.978699</td>
      <td>55.796829</td>
      <td>19.655144</td>
      <td>17.986469</td>
      <td>17.178650</td>
    </tr>
    <tr>
      <th>2020-12-14</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>41.861675</td>
      <td>75.315674</td>
      <td>10.625697</td>
      <td>8.364858</td>
      <td>13.119390</td>
    </tr>
    <tr>
      <th>2020-12-15</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>54.948017</td>
      <td>60.603752</td>
      <td>12.214766</td>
      <td>9.671446</td>
      <td>12.929519</td>
    </tr>
    <tr>
      <th>2020-12-16</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>63.984142</td>
      <td>56.931396</td>
      <td>16.307283</td>
      <td>14.952140</td>
      <td>25.290646</td>
    </tr>
    <tr>
      <th>2020-12-17</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>48.933174</td>
      <td>49.170326</td>
      <td>12.910172</td>
      <td>10.861581</td>
      <td>10.984763</td>
    </tr>
    <tr>
      <th>2020-12-18</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>21.916876</td>
      <td>64.970718</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-12-19</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>19.733660</td>
      <td>81.636444</td>
      <td>12.670108</td>
      <td>11.536630</td>
      <td>4.229946</td>
    </tr>
    <tr>
      <th>2020-12-20</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>25.818867</td>
      <td>68.821381</td>
      <td>8.510469</td>
      <td>6.051936</td>
      <td>6.062692</td>
    </tr>
    <tr>
      <th>2020-12-21</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>26.262127</td>
      <td>55.715931</td>
      <td>9.830421</td>
      <td>7.515805</td>
      <td>6.226173</td>
    </tr>
    <tr>
      <th>2020-12-22</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>69.275375</td>
      <td>74.091499</td>
      <td>38.756077</td>
      <td>33.044914</td>
      <td>25.561008</td>
    </tr>
    <tr>
      <th>2020-12-23</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>51.012043</td>
      <td>73.123276</td>
      <td>16.138432</td>
      <td>14.708934</td>
      <td>11.811040</td>
    </tr>
    <tr>
      <th>2020-12-24</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>12.582739</td>
      <td>80.724190</td>
      <td>5.150666</td>
      <td>4.405396</td>
      <td>3.355808</td>
    </tr>
    <tr>
      <th>2020-12-25</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>51.906540</td>
      <td>64.102203</td>
      <td>21.049095</td>
      <td>19.382658</td>
      <td>15.916385</td>
    </tr>
    <tr>
      <th>2020-12-26</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>46.186401</td>
      <td>69.872673</td>
      <td>17.390356</td>
      <td>16.178095</td>
      <td>7.168921</td>
    </tr>
    <tr>
      <th>2020-12-27</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>71.503342</td>
      <td>83.723030</td>
      <td>14.515577</td>
      <td>12.415962</td>
      <td>13.618376</td>
    </tr>
    <tr>
      <th>2020-12-28</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>67.383316</td>
      <td>41.268040</td>
      <td>35.509396</td>
      <td>29.793512</td>
      <td>18.922663</td>
    </tr>
    <tr>
      <th>2020-12-29</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>65.241524</td>
      <td>32.984646</td>
      <td>41.049049</td>
      <td>37.794231</td>
      <td>24.576710</td>
    </tr>
    <tr>
      <th>2020-12-30</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>84.480133</td>
      <td>23.565016</td>
      <td>36.276402</td>
      <td>32.324852</td>
      <td>39.448082</td>
    </tr>
    <tr>
      <th>2020-12-31</th>
      <td>-0.049988</td>
      <td>51.549999</td>
      <td>52.926937</td>
      <td>20.486465</td>
      <td>33.245438</td>
      <td>29.518814</td>
      <td>15.313162</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<br></div>
<div class="section" id="classify-daily-maximum-values-of-key-pollutants-into-european-air-quality-index-levels">
<h3>2.4 Classify daily maximum values of key pollutants into European Air Quality Index levels<a class="headerlink" href="#classify-daily-maximum-values-of-key-pollutants-into-european-air-quality-index-levels" title="Permalink to this headline">¶</a></h3>
<p>The next step is now to classify the daily maximum values into the respective European Air Quality Index levels. The EAQI has six index levels and different thresholds for each of the five key pollutants. First, we define the limits for each pollutant and define additionally a list with the index class labels 1 to 6.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ozone_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">380</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span>
<span class="n">no2_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
<span class="n">so2_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">1250</span><span class="p">]</span>
<span class="n">pm25_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">1200</span><span class="p">]</span>
<span class="n">pm10_limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span>

<span class="n">index_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<br><p>Based on the thresholds above, we now classify the daily maximum values of each pollutant into the respective European Air Quality Index level. The pandas function <code class="docutils literal notranslate"><span class="pre">cut()</span></code> allows us to categorize the daily maximum values into index levels. The function takes the following keyword arguments:</p>
<ul class="simple">
<li><p>pandas.Series for each pollutant, which shall be categorized</p></li>
<li><p>list of thresholds for each pollutant</p></li>
<li><p>list with index labels</p></li>
</ul>
<p>As a result, for each pollutant, the daily maximum value has been classified into one of the six index level classes, based on the pollutant thresholds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ozone</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">eaqi_ts_daily_df</span><span class="p">[</span><span class="s1">&#39;o3_conc&#39;</span><span class="p">],</span> <span class="n">ozone_limits</span> <span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">index_levels</span><span class="p">)</span>
<span class="n">no2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">eaqi_ts_daily_df</span><span class="p">[</span><span class="s1">&#39;no2_conc&#39;</span><span class="p">],</span> <span class="n">no2_limits</span> <span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">index_levels</span><span class="p">)</span>
<span class="n">so2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">eaqi_ts_daily_df</span><span class="p">[</span><span class="s1">&#39;so2_conc&#39;</span><span class="p">],</span> <span class="n">so2_limits</span> <span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">index_levels</span><span class="p">)</span>
<span class="n">pm25</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">eaqi_ts_daily_df</span><span class="p">[</span><span class="s1">&#39;pm2p5_conc&#39;</span><span class="p">],</span> <span class="n">pm25_limits</span> <span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">index_levels</span><span class="p">)</span>
<span class="n">pm10</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">eaqi_ts_daily_df</span><span class="p">[</span><span class="s1">&#39;pm10_conc&#39;</span><span class="p">],</span> <span class="n">pm10_limits</span> <span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">index_levels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<br><p>In a next step, we want to bring together the categorized pandas.Series objects above into one pandas.DataFrame. For this, we can use the constructor <code class="docutils literal notranslate"><span class="pre">pd.DataFrame()</span></code> and combine the five pandas.Series objects into one DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">o3</span> <span class="o">=</span> <span class="n">ozone</span><span class="p">,</span> <span class="n">no2</span> <span class="o">=</span> <span class="n">no2</span><span class="p">,</span> <span class="n">so2</span> <span class="o">=</span> <span class="n">so2</span><span class="p">,</span> <span class="n">pm25</span><span class="o">=</span><span class="n">pm25</span><span class="p">,</span> <span class="n">pm10</span><span class="o">=</span><span class="n">pm10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>o3</th>
      <th>no2</th>
      <th>so2</th>
      <th>pm25</th>
      <th>pm10</th>
    </tr>
    <tr>
      <th>time</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-12-01</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2020-12-02</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2020-12-03</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-04</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-05</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-06</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-07</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-08</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-09</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-10</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-11</th>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-12</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-13</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-14</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-15</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-16</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-17</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-18</th>
      <td>2</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-12-19</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-20</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2020-12-21</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2020-12-22</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-23</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-24</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2020-12-25</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2020-12-26</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-27</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-28</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-29</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-30</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-31</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<br><p>The last step before we can visualize the European Air Quality Index levels is to compute the overall index level based on the five pollutants. The overall index level for each day is defined by the pollutant with the highest level. Below, with the help of the function <code class="docutils literal notranslate"><span class="pre">max()</span></code>, we select the maximum index level for each day and define a new column with the name <code class="docutils literal notranslate"><span class="pre">level</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>o3</th>
      <th>no2</th>
      <th>so2</th>
      <th>pm25</th>
      <th>pm10</th>
      <th>level</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-12-01</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2020-12-02</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>5</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2020-12-03</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-04</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-05</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-06</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-07</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-08</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-09</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-10</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-11</th>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-12</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-13</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-14</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-15</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-16</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-17</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-18</th>
      <td>2</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-19</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-20</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-21</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-22</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-23</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-24</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-25</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2020-12-26</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-27</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2020-12-28</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-29</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-30</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2020-12-31</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<br></div>
<div class="section" id="visualize-daily-european-air-quality-index-for-london-in-december-2020-as-heatmap">
<h3>2.5 Visualize daily European Air Quality Index for London in December 2020 as heatmap<a class="headerlink" href="#visualize-daily-european-air-quality-index-for-london-in-december-2020-as-heatmap" title="Permalink to this headline">¶</a></h3>
<p>The last step is now to visualize the daily European Air Quality Index for London in December 2020 as heatmap. We can use the function <code class="docutils literal notranslate"><span class="pre">heatmap()</span></code> from the <a class="reference external" href="https://seaborn.pydata.org/examples/index.html">seaborn</a> library to create a heatmap with days on the horizontal axis and the pollutants as well as the overall index level on the vertical axis. This representation allows for a quick interpretation on the overall index level for every day. It further allows you to identify the determining pollutant for every day.</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">heatmap()</span></code> function, we need to transpose the dataframe, so that the key pollutants and overall index level are given as row entries and for every day in December 2020 a column entry. Additionally, with <code class="docutils literal notranslate"><span class="pre">iloc[::-1]</span></code>, we want to revert the sequence of the pollutants, as we want to visualize the overall index level on top.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>index</th>
      <th>2020-12-01</th>
      <th>2020-12-02</th>
      <th>2020-12-03</th>
      <th>2020-12-04</th>
      <th>2020-12-05</th>
      <th>2020-12-06</th>
      <th>2020-12-07</th>
      <th>2020-12-08</th>
      <th>2020-12-09</th>
      <th>2020-12-10</th>
      <th>...</th>
      <th>2020-12-22</th>
      <th>2020-12-23</th>
      <th>2020-12-24</th>
      <th>2020-12-25</th>
      <th>2020-12-26</th>
      <th>2020-12-27</th>
      <th>2020-12-28</th>
      <th>2020-12-29</th>
      <th>2020-12-30</th>
      <th>2020-12-31</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>level</th>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>pm10</th>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>pm25</th>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>so2</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>no2</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>o3</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 31 columns</p>
</div></div></div>
</div>
<p>The transpose function converts <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values to a large negative number. For this reason, we have to set negative entries back to <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (not  a number).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>index</th>
      <th>2020-12-01</th>
      <th>2020-12-02</th>
      <th>2020-12-03</th>
      <th>2020-12-04</th>
      <th>2020-12-05</th>
      <th>2020-12-06</th>
      <th>2020-12-07</th>
      <th>2020-12-08</th>
      <th>2020-12-09</th>
      <th>2020-12-10</th>
      <th>...</th>
      <th>2020-12-22</th>
      <th>2020-12-23</th>
      <th>2020-12-24</th>
      <th>2020-12-25</th>
      <th>2020-12-26</th>
      <th>2020-12-27</th>
      <th>2020-12-28</th>
      <th>2020-12-29</th>
      <th>2020-12-30</th>
      <th>2020-12-31</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>level</th>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>pm10</th>
      <td>3</td>
      <td>5</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>2</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>pm25</th>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>so2</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>no2</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>o3</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 31 columns</p>
</div></div></div>
</div>
<br><p>And now, we can finally visualize the heatmap. The code below has five main parts:</p>
<ul class="simple">
<li><p><strong>1. Initiate the matplotlib figure</strong>: Initiate a figure and axes objects and add a colorbar</p></li>
<li><p><strong>2. Plotting function</strong>: Plot the pandas dataframe with the heatmap() function from the seaborn library</p></li>
<li><p><strong>3. Set title of the heatmap</strong>: Set a title to the resulting heatmap</p></li>
<li><p><strong>4. Customize x- and y-axis ticks and labels:</strong> Customize the x- and y-labels for correct representation of the data</p></li>
<li><p><strong>5. Customize colorbar entries:</strong> Customize the labels of the colorbar and indicate the index levels from ‘very good’ to ‘extremely poor’</p></li>
</ul>
<p><strong>Note:</strong> before plotting, we additionally define a customized colormap based on the official EAQI index colors. We also add additionally the labels to the six EAQI index levels, which range from ‘Very good’ to ‘Extremely poor’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;#5AAA5F&#39;</span><span class="p">,</span> <span class="s1">&#39;#A7D25C&#39;</span><span class="p">,</span> <span class="s1">&#39;#ECD347&#39;</span><span class="p">,</span> <span class="s1">&#39;#F5BE41&#39;</span><span class="p">,</span> <span class="s1">&#39;#F09235&#39;</span><span class="p">,</span> <span class="s1">&#39;#D93322&#39;</span><span class="p">])</span>
<span class="n">cmap</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Very good&#39;</span><span class="p">,</span> <span class="s1">&#39;Good&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Poor&#39;</span><span class="p">,</span> <span class="s1">&#39;Very Poor&#39;</span><span class="p">,</span> <span class="s1">&#39;Extremely Poor&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiate the matplotlib figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">.82</span><span class="p">,</span> <span class="mf">.13</span><span class="p">,</span> <span class="mf">.01</span><span class="p">,</span> <span class="mf">.75</span><span class="p">])</span>

<span class="c1"># Plotting function</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">cbar_ax</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Set title of the heatmap</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Daily European Air Quality Index levels for London - December 2020</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># Customize x- and y-axis ticks and labels</span>
<span class="n">ylabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Index level&#39;</span><span class="p">,</span> <span class="s1">&#39;PM 10&#39;</span><span class="p">,</span> <span class="s1">&#39;PM 2.5&#39;</span><span class="p">,</span> <span class="s1">&#39;Sulphur dioxide&#39;</span><span class="p">,</span> <span class="s1">&#39;Nitrogen dioxide&#39;</span><span class="p">,</span> <span class="s1">&#39;Ozone&#39;</span><span class="p">]</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ylabels</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">xlabels</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">::]</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Customize colorbar entries</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">colorbar</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">2.2</span><span class="p">,</span><span class="mf">3.1</span><span class="p">,</span><span class="mf">3.9</span><span class="p">,</span><span class="mf">4.8</span><span class="p">,</span><span class="mf">5.6</span><span class="p">])</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">([</span><span class="s1">&#39;Very good&#39;</span><span class="p">,</span> <span class="s1">&#39;Good&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;Poor&#39;</span><span class="p">,</span> <span class="s1">&#39;Very Poor&#39;</span><span class="p">,</span> <span class="s1">&#39;Extremely Poor&#39;</span><span class="p">])</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07_European_Air_Quality_Index_Calculation_126_0.png" src="_images/07_European_Air_Quality_Index_Calculation_126_0.png" />
</div>
</div>
<br><hr><p></p>
<span style='float:right'><p style=\"text-align:right;\">This project is licensed under <a href="./LICENSE">APACHE License 2.0</a>. | <a href=\"https://github.com/ecmwf-projects/copernicus-training">View on GitHub</a></span></div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="06_Profile_Plot_Zonal_Mean.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Profile Plots and Zonal Means</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="08_Ozone_Monitoring_Tutorial.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ozone Monitoring Tutorial</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By the Copernicus Atmosphere Monitoring Service (CAMS), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>